(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,667585,(e,a,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let s=e.r(132061);function l({reason:e,children:a}){if("undefined"==typeof window)throw Object.defineProperty(new s.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return a}},309885,(e,a,t)=>{"use strict";function s(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"encodeURIPath",{enumerable:!0,get:function(){return s}})},652157,(e,a,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return i}});let s=e.r(843476),l=e.r(174080),r=e.r(563599),n=e.r(309885);function i({moduleIds:e}){if("undefined"!=typeof window)return null;let a=r.workAsyncStorage.getStore();if(void 0===a)return null;let t=[];if(a.reactLoadableManifest&&e){let s=a.reactLoadableManifest;for(let a of e){if(!s[a])continue;let e=s[a].files;t.push(...e)}}return 0===t.length?null:(0,s.jsx)(s.Fragment,{children:t.map(e=>{let t=`${a.assetPrefix}/_next/${(0,n.encodeURIPath)(e)}`;return e.endsWith(".css")?(0,s.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style",nonce:a.nonce},e):((0,l.preload)(t,{as:"script",fetchPriority:"low",nonce:a.nonce}),null)})})}},869093,(e,a,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let s=e.r(843476),l=e.r(271645),r=e.r(667585),n=e.r(652157);function i(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},c=function(e){let a={...d,...e},t=(0,l.lazy)(()=>a.loader().then(i)),c=a.loading;function o(e){let i=c?(0,s.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,d=!a.ssr||!!a.loading,o=d?l.Suspense:l.Fragment,m=a.ssr?(0,s.jsxs)(s.Fragment,{children:["undefined"==typeof window?(0,s.jsx)(n.PreloadChunks,{moduleIds:a.modules}):null,(0,s.jsx)(t,{...e})]}):(0,s.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(t,{...e})});return(0,s.jsx)(o,{...d?{fallback:i}:{},children:m})}return o.displayName="LoadableComponent",o}},770703,(e,a,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let s=e.r(555682)._(e.r(869093));function l(e,a){let t={};"function"==typeof e&&(t.loader=e);let l={...t,...a};return(0,s.default)({...l,modules:l.loadableGenerated?.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),a.exports=t.default)},752339,e=>{"use strict";var a=e.i(843476),t=e.i(271645),s=e.i(970065),l=e.i(167881),r=e.i(127341),n=e.i(263488),i=e.i(514764),d=e.i(269638),c=e.i(620278),o=e.i(761911),m=e.i(217923),u=e.i(107233),x=e.i(994179),h=e.i(503116),p=e.i(878894),g=e.i(475254);let j=(0,g.default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var f=e.i(431343),b=e.i(495242),v=e.i(727612);let y=(0,g.default)("mouse-pointer-click",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]);var N=e.i(38982),C=e.i(463415),w=e.i(174117),k=e.i(287336),S=e.i(87446),T=e.i(630374),D=e.i(23750),_=e.i(10708),L=e.i(62870);function E(){let[e,r]=(0,t.useState)([]),[c,m]=(0,t.useState)(!0),{toast:u}=(0,w.useToast)(),[g,E]=(0,t.useState)({open:!1}),[I,B]=(0,t.useState)(""),[F,P]=(0,t.useState)(""),[O,A]=(0,t.useState)(""),[M,H]=(0,t.useState)(""),[U,z]=(0,t.useState)("1000"),[$,q]=(0,t.useState)("0.95"),[R,V]=(0,t.useState)("open_rate");(0,t.useEffect)(()=>{W()},[]);let W=async()=>{try{let e=await fetch("/api/email");if(e.ok){let a=await e.json();r(a.campaigns||[])}}catch(e){console.error("Failed to fetch campaigns:",e),u({title:"Error",description:"Failed to load campaigns",variant:"destructive"})}finally{m(!1)}},J=async(e,a)=>{try{let t=e.instantly_id||e.instantlyData?.id||e.id;(await (0,S.fetchWithCsrf)("/api/email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify("active"===a?{type:"launch",data:t}:{type:"update-status",data:{instantlyId:t,status:a}})})).ok&&(u({title:"Success",description:`Campaign ${"active"===a?"started":"paused"}`}),W())}catch(e){u({title:"Error",description:"Failed to update campaign",variant:"destructive"})}},K=async e=>{if(confirm("Are you sure you want to delete this campaign?"))try{(await (0,S.fetchWithCsrf)(`/api/outreach/campaigns?id=${e}`,{method:"DELETE"})).ok&&(u({title:"Success",description:"Campaign deleted"}),W())}catch(e){u({title:"Error",description:"Failed to delete campaign",variant:"destructive"})}},G=async()=>{try{if(!g.campaign)return;if(!I||!O||!M)return void u({title:"Fehler",description:"Name und beide Varianten erforderlich",variant:"destructive"});let e={name:I,description:F,campaign_type:"email",original_template_id:g.campaign.template_id,test_variants:[{id:"A",name:O},{id:"B",name:M}],sample_size:parseInt(U)||1e3,confidence_level:parseFloat($)||.95,test_metric:R},a=await (0,S.fetchWithCsrf)("/api/intelligence/ab-testing",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e?.error||"A/B-Test konnte nicht erstellt werden")}u({title:"A/B-Test erstellt",description:"Test wurde angelegt und initialisiert"}),E({open:!1}),B(""),P(""),A(""),H("")}catch(e){u({title:"Fehler",description:e?.message||"Unbekannter Fehler",variant:"destructive"})}},X=e=>0===e.sent_count?"0%":`${(e.opened_count/e.sent_count*100).toFixed(1)}%`,Q=e=>0===e.opened_count?"0%":`${(e.clicked_count/e.opened_count*100).toFixed(1)}%`;return c?(0,a.jsx)("div",{className:"text-center py-8",children:"Loading campaigns..."}):0===e.length?(0,a.jsx)(s.Card,{className:"border-dashed",children:(0,a.jsxs)(s.CardContent,{className:"py-16 text-center",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:(0,a.jsx)(i.Send,{className:"h-8 w-8 text-primary"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No campaigns yet"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Create your first email campaign to start reaching out to leads"}),(0,a.jsxs)(l.Button,{size:"lg",children:[(0,a.jsx)(i.Send,{className:"h-4 w-4 mr-2"}),"Create Your First Campaign"]})]})}):(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.map(e=>{let t=parseFloat(X(e).replace("%","")),r=parseFloat(Q(e).replace("%",""));return(0,a.jsxs)(s.Card,{className:"group hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[(0,a.jsxs)(s.CardHeader,{className:"pb-3",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsx)(x.Badge,{className:(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"draft":default:return"bg-gray-100 text-gray-800";case"paused":return"bg-yellow-100 text-yellow-800"}})(e.status),children:(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(e=>{switch(e){case"active":return(0,a.jsx)(i.Send,{className:"h-3 w-3"});case"completed":return(0,a.jsx)(d.CheckCircle,{className:"h-3 w-3"});case"draft":default:return(0,a.jsx)(h.Clock,{className:"h-3 w-3"});case"paused":return(0,a.jsx)(p.AlertTriangle,{className:"h-3 w-3"})}})(e.status),e.status]})}),(0,a.jsxs)(C.DropdownMenu,{children:[(0,a.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,a.jsx)(j,{className:"h-4 w-4"})})}),(0,a.jsxs)(C.DropdownMenuContent,{align:"end",children:["draft"===e.status&&(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>J(e,"active"),children:[(0,a.jsx)(f.Play,{className:"h-4 w-4 mr-2"}),"Start Campaign"]}),"active"===e.status&&(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>J(e,"paused"),children:[(0,a.jsx)(b.Pause,{className:"h-4 w-4 mr-2"}),"Pause Campaign"]}),"paused"===e.status&&(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>J(e,"active"),children:[(0,a.jsx)(f.Play,{className:"h-4 w-4 mr-2"}),"Resume Campaign"]}),(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>K(e.id),className:"text-red-600",children:[(0,a.jsx)(v.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]}),(0,a.jsxs)(C.DropdownMenuItem,{onClick:()=>E({open:!0,campaign:e}),children:[(0,a.jsx)(N.FlaskConical,{className:"h-4 w-4 mr-2"}),"Start A/B Test"]})]})]})]}),(0,a.jsx)(s.CardTitle,{className:"text-xl line-clamp-2",children:e.name}),(0,a.jsxs)(s.CardDescription,{className:"flex items-center gap-1 text-xs",children:[(0,a.jsx)(h.Clock,{className:"h-3 w-3"}),new Date(e.created_at).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric"})]})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950/30 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(n.Mail,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),(0,a.jsx)("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:"Sent"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:e.sent_count})]}),(0,a.jsxs)("div",{className:"bg-green-50 dark:bg-green-950/30 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(d.CheckCircle,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),(0,a.jsx)("span",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:"Delivered"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:e.delivered_count})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-sm font-medium flex items-center gap-1",children:[(0,a.jsx)(n.Mail,{className:"h-3 w-3"}),"Open Rate"]}),(0,a.jsx)("span",{className:"text-sm font-bold",children:X(e)})]}),(0,a.jsx)(k.Progress,{value:t,className:"h-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-sm font-medium flex items-center gap-1",children:[(0,a.jsx)(y,{className:"h-3 w-3"}),"Click Rate"]}),(0,a.jsx)("span",{className:"text-sm font-bold",children:Q(e)})]}),(0,a.jsx)(k.Progress,{value:r,className:"h-2"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,a.jsx)(o.Users,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[e.leads_count," leads"]})]}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-8",children:"View Details"})]})]})]},e.id)}),(0,a.jsx)(T.Dialog,{open:g.open,onOpenChange:e=>E({open:e,campaign:g.campaign}),children:(0,a.jsxs)(T.DialogContent,{children:[(0,a.jsxs)(T.DialogHeader,{children:[(0,a.jsx)(T.DialogTitle,{children:"Neuen A/B-Test erstellen"}),(0,a.jsxs)(T.DialogDescription,{children:["Teste Varianten für ",g.campaign?.name||"Kampagne"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Name *"}),(0,a.jsx)(D.Input,{value:I,onChange:e=>B(e.target.value),placeholder:"Betreff-Test Q4"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Beschreibung"}),(0,a.jsx)(D.Input,{value:F,onChange:e=>P(e.target.value),placeholder:"Vergleich zweier Betreffzeilen"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Variante A *"}),(0,a.jsx)(D.Input,{value:O,onChange:e=>A(e.target.value),placeholder:"z. B. Betreff A"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Variante B *"}),(0,a.jsx)(D.Input,{value:M,onChange:e=>H(e.target.value),placeholder:"z. B. Betreff B"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Sample Size"}),(0,a.jsx)(D.Input,{value:U,onChange:e=>z(e.target.value),placeholder:"1000"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Confidence"}),(0,a.jsxs)(L.Select,{value:$,onValueChange:q,children:[(0,a.jsx)(L.SelectTrigger,{children:(0,a.jsx)(L.SelectValue,{})}),(0,a.jsxs)(L.SelectContent,{children:[(0,a.jsx)(L.SelectItem,{value:"0.90",children:"90%"}),(0,a.jsx)(L.SelectItem,{value:"0.95",children:"95%"}),(0,a.jsx)(L.SelectItem,{value:"0.99",children:"99%"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Metric"}),(0,a.jsxs)(L.Select,{value:R,onValueChange:V,children:[(0,a.jsx)(L.SelectTrigger,{children:(0,a.jsx)(L.SelectValue,{})}),(0,a.jsxs)(L.SelectContent,{children:[(0,a.jsx)(L.SelectItem,{value:"open_rate",children:"Open Rate"}),(0,a.jsx)(L.SelectItem,{value:"click_rate",children:"Click Rate"}),(0,a.jsx)(L.SelectItem,{value:"reply_rate",children:"Reply Rate"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(l.Button,{variant:"outline",onClick:()=>E({open:!1}),children:"Abbrechen"}),(0,a.jsxs)(l.Button,{onClick:G,children:[(0,a.jsx)(N.FlaskConical,{className:"h-4 w-4 mr-2"}),"Test starten"]})]})]})]})})]})}function I({open:e,onOpenChange:s,onSuccess:r}){let[n,i]=(0,t.useState)(""),[d,c]=(0,t.useState)(""),[o,m]=(0,t.useState)([]),[u,x]=(0,t.useState)(!1);(0,t.useEffect)(()=>{e&&h()},[e]);let h=async()=>{try{let e=await fetch("/api/outreach/templates");if(e.ok){let a=await e.json();m(a.templates||[])}}catch(e){console.error("Failed to fetch templates:",e)}},p=async e=>{e.preventDefault(),x(!0);try{(await fetch("/api/outreach/campaigns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,subject:o.find(e=>e.id===d)?.subject||"",templateId:d,leadsCount:0})})).ok&&(r(),s(!1),i(""),c(""))}catch(e){console.error("Failed to create campaign:",e)}finally{x(!1)}};return(0,a.jsx)(T.Dialog,{open:e,onOpenChange:s,children:(0,a.jsxs)(T.DialogContent,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(T.DialogHeader,{children:[(0,a.jsx)(T.DialogTitle,{children:"Create New Campaign"}),(0,a.jsx)(T.DialogDescription,{children:"Set up a new email outreach campaign"})]}),(0,a.jsxs)("form",{onSubmit:p,children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(_.Label,{htmlFor:"name",children:"Campaign Name"}),(0,a.jsx)(D.Input,{id:"name",value:n,onChange:e=>i(e.target.value),placeholder:"Q1 Outreach Campaign",required:!0})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(_.Label,{htmlFor:"template",children:"Email Template"}),(0,a.jsxs)(L.Select,{value:d,onValueChange:c,required:!0,children:[(0,a.jsx)(L.SelectTrigger,{children:(0,a.jsx)(L.SelectValue,{placeholder:"Select a template"})}),(0,a.jsx)(L.SelectContent,{children:o.map(e=>(0,a.jsx)(L.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]}),(0,a.jsxs)(T.DialogFooter,{children:[(0,a.jsx)(l.Button,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,a.jsx)(l.Button,{type:"submit",disabled:u||!n||!d,children:u?"Creating...":"Create Campaign"})]})]})]})})}var B=e.i(184762),F=e.i(356909),P=e.i(286536);function O({onSave:e,initialTemplate:r}){let[n,i]=(0,t.useState)(r?.name||""),[d,c]=(0,t.useState)(r?.subject||""),[o,m]=(0,t.useState)(r?.content||""),[u,h]=(0,t.useState)(r?.category||"Introduction"),[p,g]=(0,t.useState)(!1),[j,f]=(0,t.useState)(!1),b=e=>{let a=e.match(/\{\{(\w+)\}\}/g);return a?[...new Set(a.map(e=>e.replace(/[{}]/g,"")))]:[]},v=[...new Set([...b(d),...b(o)])],y=async()=>{f(!0);try{let a=r?.id?"PUT":"POST",t=r?.id?{id:r.id,name:n,subject:d,content:o,category:u}:{name:n,subject:d,content:o,category:u},s=await fetch("/api/outreach/templates",{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(s.ok){let a=await s.json();e?.(a.template)}}catch(e){console.error("Failed to save template:",e)}finally{f(!1)}},N=e=>{let a=e;return Object.entries({firstName:"John",lastName:"Doe",fullName:"John Doe",company:"Acme Corp",jobTitle:"CEO",email:"john@acme.com"}).forEach(([e,t])=>{a=a.replace(RegExp(`\\{\\{${e}\\}\\}`,"g"),t)}),a};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(s.Card,{className:"border-2",children:[(0,a.jsxs)(s.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-primary/10",children:[(0,a.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(F.Save,{className:"h-5 w-5 text-primary"})}),"Template Details"]}),(0,a.jsx)(s.CardDescription,{children:"Create reusable email templates with dynamic variables for personalized outreach"})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-6 pt-6",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(_.Label,{htmlFor:"name",children:"Template Name"}),(0,a.jsx)(D.Input,{id:"name",value:n,onChange:e=>i(e.target.value),placeholder:"Introduction Email"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(_.Label,{htmlFor:"category",children:"Category"}),(0,a.jsx)(D.Input,{id:"category",value:u,onChange:e=>h(e.target.value),placeholder:"Introduction, Follow-up, etc."})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(_.Label,{htmlFor:"subject",children:"Subject Line"}),(0,a.jsx)(D.Input,{id:"subject",value:d,onChange:e=>c(e.target.value),placeholder:"Let's connect, {{firstName}}"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(_.Label,{htmlFor:"content",children:"Email Content"}),(0,a.jsx)(B.Textarea,{id:"content",value:o,onChange:e=>m(e.target.value),placeholder:"Hi {{firstName}},  I noticed your role as {{jobTitle}} at {{company}}...  Best regards",rows:12}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Use double curly braces for variables: ","{{firstName}}, {{company}}, {{jobTitle}}"]})]}),v.length>0&&(0,a.jsxs)("div",{className:"grid gap-3",children:[(0,a.jsx)(_.Label,{className:"text-base font-semibold",children:"Detected Variables"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 p-4 bg-muted/50 rounded-lg border-2 border-dashed",children:v.map(e=>(0,a.jsx)(x.Badge,{variant:"secondary",className:"text-sm px-3 py-1",children:`{{${e}}}`},e))}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"These variables will be automatically replaced with lead data when sending emails"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,a.jsxs)(l.Button,{onClick:y,disabled:j||!n||!d||!o,size:"lg",className:"flex-1",children:[(0,a.jsx)(F.Save,{className:"h-4 w-4 mr-2"}),j?"Saving...":"Save Template"]}),(0,a.jsxs)(l.Button,{variant:"outline",onClick:()=>g(!p),size:"lg",children:[(0,a.jsx)(P.Eye,{className:"h-4 w-4 mr-2"}),p?"Hide":"Show"," Preview"]})]})]})]}),p&&(0,a.jsxs)(s.Card,{className:"border-2 border-primary/20 shadow-lg",children:[(0,a.jsxs)(s.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-primary/10",children:[(0,a.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,a.jsx)(P.Eye,{className:"h-5 w-5 text-primary"})}),"Email Preview"]}),(0,a.jsx)(s.CardDescription,{children:"How your email will look with sample data (John Doe from Acme Corp)"})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-6 pt-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{className:"text-sm font-semibold text-muted-foreground",children:"SUBJECT LINE"}),(0,a.jsx)("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900 rounded-lg border-2 border-blue-200 dark:border-blue-800",children:(0,a.jsx)("p",{className:"font-semibold text-lg",children:N(d)})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{className:"text-sm font-semibold text-muted-foreground",children:"EMAIL CONTENT"}),(0,a.jsx)("div",{className:"p-6 bg-white dark:bg-gray-950 rounded-lg border-2 shadow-sm",children:(0,a.jsx)("div",{className:"whitespace-pre-wrap text-base leading-relaxed",children:N(o)})})]})]})]})]})}var A=e.i(688511),M=e.i(174886),H=e.i(555436);function U({onEdit:e,onSelect:r}){let[i,d]=(0,t.useState)([]),[c,o]=(0,t.useState)(!0),[m,h]=(0,t.useState)(""),{toast:p}=(0,w.useToast)();(0,t.useEffect)(()=>{g()},[]);let g=async()=>{try{let e=await fetch("/api/outreach/templates");if(e.ok){let a=await e.json();d(a.templates||[])}}catch(e){console.error("Failed to fetch templates:",e),p({title:"Error",description:"Failed to load templates",variant:"destructive"})}finally{o(!1)}},f=async e=>{if(confirm("Delete this template?"))try{(await (0,S.fetchWithCsrf)(`/api/outreach/templates?id=${e}`,{method:"DELETE"})).ok&&(d(i.filter(a=>a.id!==e)),p({title:"Success",description:"Template deleted successfully"}))}catch(e){console.error("Failed to delete template:",e),p({title:"Error",description:"Failed to delete template",variant:"destructive"})}},b=async e=>{try{(await (0,S.fetchWithCsrf)("/api/outreach/templates",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:`${e.name} (Copy)`,subject:e.subject,content:e.content,html_content:e.html_content,category:e.category})})).ok&&(g(),p({title:"Success",description:"Template duplicated successfully"}))}catch(e){console.error("Failed to duplicate template:",e),p({title:"Error",description:"Failed to duplicate template",variant:"destructive"})}},y=i.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.subject.toLowerCase().includes(m.toLowerCase())||e.category.toLowerCase().includes(m.toLowerCase()));return c?(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,a.jsxs)(s.Card,{className:"animate-pulse",children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 mt-2"})]}),(0,a.jsx)(s.CardContent,{children:(0,a.jsx)("div",{className:"h-20 bg-gray-200 rounded"})})]},e))}):0===i.length?(0,a.jsx)(s.Card,{className:"border-dashed",children:(0,a.jsxs)(s.CardContent,{className:"py-16 text-center",children:[(0,a.jsx)(n.Mail,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No templates yet"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Create your first email template to get started"}),(0,a.jsxs)(l.Button,{onClick:()=>e?.(void 0),children:[(0,a.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Create Template"]})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(H.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(D.Input,{placeholder:"Search templates...",value:m,onChange:e=>h(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(l.Button,{onClick:()=>e?.(void 0),children:[(0,a.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"New Template"]})]}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:y.map(t=>(0,a.jsxs)(s.Card,{className:"group hover:shadow-lg transition-all duration-300 hover:-translate-y-1 cursor-pointer",onClick:()=>r?.(t),children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(x.Badge,{variant:"outline",className:"mb-2",children:t.category}),(0,a.jsx)(s.CardTitle,{className:"text-lg line-clamp-1",children:t.name}),(0,a.jsx)(s.CardDescription,{className:"line-clamp-1 mt-1",children:t.subject})]}),(0,a.jsxs)(C.DropdownMenu,{children:[(0,a.jsx)(C.DropdownMenuTrigger,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(j,{className:"h-4 w-4"})})}),(0,a.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,a.jsxs)(C.DropdownMenuItem,{onClick:a=>{a.stopPropagation(),e?.(t)},children:[(0,a.jsx)(A.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,a.jsxs)(C.DropdownMenuItem,{onClick:e=>{e.stopPropagation(),b(t)},children:[(0,a.jsx)(M.Copy,{className:"h-4 w-4 mr-2"}),"Duplicate"]}),(0,a.jsxs)(C.DropdownMenuItem,{onClick:e=>{e.stopPropagation(),f(t.id)},className:"text-red-600",children:[(0,a.jsx)(v.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})}),(0,a.jsx)(s.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"p-3 bg-muted/50 rounded-lg text-sm line-clamp-3",children:[t.content?.substring(0,150)||t.html_content?.replace(/<[^>]*>/g,"").substring(0,150)||"No content",(t.content?.length||0)>150&&"..."]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:new Date(t.created_at).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.Mail,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:t.html_content?"HTML":"Text"})]})]})]})})]},t.id))}),0===y.length&&m&&(0,a.jsx)(s.Card,{className:"border-dashed",children:(0,a.jsxs)(s.CardContent,{className:"py-12 text-center",children:[(0,a.jsx)(H.Search,{className:"h-8 w-8 text-muted-foreground mx-auto mb-3"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:['No templates found for "',m,'"']})]})})]})}var z=e.i(625959),$=e.i(471435);function q({open:e,onOpenChange:s,campaignId:r,templateId:n,onSuccess:d}){let[c,o]=(0,t.useState)([]),[m,u]=(0,t.useState)([]),[x,h]=(0,t.useState)(!1),[p,g]=(0,t.useState)(!1),[j,f]=(0,t.useState)([]),[b,v]=(0,t.useState)("");(0,t.useEffect)(()=>{e&&(y(),N())},[e]);let y=async()=>{try{let e=await fetch("/api/lead-lists");if(e.ok){let a=await e.json();f(a.lists||[])}}catch(e){console.error("Failed to fetch lead lists:",e)}},N=async()=>{h(!0);try{let e=b?`/api/leads?listId=${b}`:"/api/leads",a=await fetch(e);if(a.ok){let e=((await a.json()).leads||[]).filter(e=>e.email&&e.email.includes("@"));o(e)}}catch(e){console.error("Failed to fetch leads:",e)}finally{h(!1)}},C=async()=>{if(0!==m.length){g(!0);try{let e=await (0,S.fetchWithCsrf)("/api/outreach/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:r,templateId:n,leadIds:m,sendNow:!0})});if(e.ok){let a=await e.json();alert(`Emails sent successfully!
Sent: ${a.sent}
Failed: ${a.failed}`),d(),s(!1),u([])}}catch(e){console.error("Failed to send emails:",e),alert("Failed to send emails. Please try again.")}finally{g(!1)}}};return(0,a.jsx)(T.Dialog,{open:e,onOpenChange:s,children:(0,a.jsxs)(T.DialogContent,{className:"sm:max-w-[600px]",children:[(0,a.jsxs)(T.DialogHeader,{children:[(0,a.jsx)(T.DialogTitle,{children:"Send Campaign Emails"}),(0,a.jsxs)(T.DialogDescription,{children:["Select leads to send emails to. Selected: ",m.length," / ",c.length]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(_.Label,{className:"mb-1 block",children:"Lead-Liste"}),(0,a.jsxs)(L.Select,{value:b,onValueChange:e=>{v("all"===e?"":e),N()},children:[(0,a.jsx)(L.SelectTrigger,{children:(0,a.jsx)(L.SelectValue,{placeholder:"Alle Leads"})}),(0,a.jsxs)(L.SelectContent,{children:[(0,a.jsx)(L.SelectItem,{value:"all",children:"Alle Leads"}),j.map(e=>(0,a.jsxs)(L.SelectItem,{value:e.id,children:[e.name," ","number"==typeof e.leads_count?`(${e.leads_count})`:""]},e.id))]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(z.Checkbox,{id:"select-all",checked:m.length===c.length&&c.length>0,onCheckedChange:()=>{m.length===c.length?u([]):u(c.map(e=>e.id))}}),(0,a.jsx)(_.Label,{htmlFor:"select-all",className:"font-medium",children:"Select All"})]})]}),(0,a.jsx)($.ScrollArea,{className:"h-[400px] border rounded-md p-4",children:x?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Loading leads..."}):0===c.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No leads with valid email addresses found"}):(0,a.jsx)("div",{className:"space-y-2",children:c.map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-2 p-2 hover:bg-muted/50 rounded-md",children:[(0,a.jsx)(z.Checkbox,{id:e.id,checked:m.includes(e.id),onCheckedChange:()=>{var a;return a=e.id,void u(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])}}),(0,a.jsxs)(_.Label,{htmlFor:e.id,className:"flex-1 cursor-pointer",children:[(0,a.jsx)("div",{className:"font-medium",children:e.full_name}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.email,e.company&&` • ${e.company}`,e.job_title&&` • ${e.job_title}`]})]})]},e.id))})})]}),(0,a.jsxs)(T.DialogFooter,{children:[(0,a.jsx)(l.Button,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),(0,a.jsxs)(l.Button,{onClick:C,disabled:p||0===m.length,children:[(0,a.jsx)(i.Send,{className:"h-4 w-4 mr-2"}),p?"Sending...":`Send to ${m.length} Lead${1!==m.length?"s":""}`]})]})]})})}var R=e.i(770703),V=e.i(283086);let W=(0,g.default)("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),J=(0,R.default)(()=>e.A(661065).then(e=>e.default),{loadableGenerated:{modules:[192158]},ssr:!1});function K({onSave:e,initialTemplate:r}){let n,i=(0,t.useRef)(null),[d,c]=(0,t.useState)(r?.name||""),[o,m]=(0,t.useState)(r?.subject||""),[u,h]=(0,t.useState)(r?.category||"Marketing"),[p,g]=(0,t.useState)(!1),[j,f]=(0,t.useState)(!1),{toast:b}=(0,w.useToast)(),v=(n=o.match(/\{\{(\w+)\}\}/g))?[...new Set(n.map(e=>e.replace(/[{}]/g,"")))]:[],y=async()=>{f(!0);try{let e=await fetch("/api/ai/generate-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({purpose:"professional outreach",targetAudience:"B2B decision makers",tone:"professional",length:"medium",useKnowledgeBase:!0})});if(e.ok){let a=await e.json();m(a.subject);let t=i.current?.editor;if(t){let e=N(a.content);t.loadDesign(e)}b({title:"AI Generated!",description:"Email content has been generated successfully."})}}catch(e){console.error("AI generation failed:",e),b({title:"Error",description:"Failed to generate email content.",variant:"destructive"})}finally{f(!1)}},N=e=>({body:{rows:[{cells:[1],columns:[{contents:[{type:"text",values:{containerPadding:"20px",_meta:{htmlID:"u_content_text_1"},color:"#ffffff",textAlign:"center",lineHeight:"140%",linkStyle:{inherit:!0,linkColor:"#0000ee",linkHoverColor:"#0000ee",linkUnderline:!0,linkHoverUnderline:!0},hideDesktop:!1,displayCondition:null,_override:{mobile:{hideMobile:!1,textAlign:"center"}},selectable:!0,draggable:!0,duplicatable:!0,deletable:!0,text:'<h1 style="margin: 0; font-size: 28px; font-weight: 700;">{{company}}</h1>'}}]}],values:{backgroundColor:"#667eea",backgroundImage:{url:"",fullWidth:!0,repeat:!1,center:!0,cover:!1},padding:"30px 0px",_meta:{htmlID:"u_row_1"}}},...e.split("\n\n").filter(e=>e.trim()).map((e,a)=>({cells:[1],columns:[{contents:[{type:"text",values:{containerPadding:"20px",_meta:{htmlID:`u_content_text_${a+2}`},color:"#333333",textAlign:"left",lineHeight:"160%",linkStyle:{inherit:!0,linkColor:"#667eea",linkHoverColor:"#764ba2",linkUnderline:!0,linkHoverUnderline:!0},hideDesktop:!1,displayCondition:null,_override:{mobile:{hideMobile:!1}},selectable:!0,draggable:!0,duplicatable:!0,deletable:!0,text:`<p style="margin: 0; font-size: 16px;">${e}</p>`}}]}],values:{backgroundColor:"#ffffff",padding:"10px 0px",_meta:{htmlID:`u_row_${a+2}`}}})),{cells:[1],columns:[{contents:[{type:"button",values:{containerPadding:"20px",_meta:{htmlID:"u_content_button_1"},href:{name:"web",values:{href:"{{ctaLink}}",target:"_blank"}},buttonColors:{color:"#ffffff",backgroundColor:"#667eea",hoverColor:"#ffffff",hoverBackgroundColor:"#764ba2"},size:{autoWidth:!1,width:"100%"},textAlign:"center",lineHeight:"120%",padding:"15px 40px",border:{},borderRadius:"8px",hideDesktop:!1,displayCondition:null,_override:{mobile:{hideMobile:!1}},selectable:!0,draggable:!0,duplicatable:!0,deletable:!0,text:'<span style="font-size: 16px; font-weight: 700;">Get Started</span>'}}]}],values:{backgroundColor:"#ffffff",padding:"20px 0px",_meta:{htmlID:"u_row_button"}}},{cells:[1],columns:[{contents:[{type:"text",values:{containerPadding:"20px",_meta:{htmlID:"u_content_text_footer"},color:"#666666",textAlign:"center",lineHeight:"140%",linkStyle:{inherit:!0,linkColor:"#667eea",linkHoverColor:"#764ba2",linkUnderline:!0,linkHoverUnderline:!0},hideDesktop:!1,displayCondition:null,_override:{mobile:{hideMobile:!1,textAlign:"center"}},selectable:!0,draggable:!0,duplicatable:!0,deletable:!0,text:'<p style="margin: 0; font-size: 12px;">&copy; 2024 {{company}}. All rights reserved.</p><p style="margin: 5px 0 0 0; font-size: 12px;"><a href="{{unsubscribeLink}}" style="color: #667eea;">Unsubscribe</a></p>'}}]}],values:{backgroundColor:"#f5f5f5",padding:"20px 0px",_meta:{htmlID:"u_row_footer"}}}],values:{backgroundColor:"#f5f5f5",backgroundImage:{url:"",fullWidth:!0,repeat:!1,center:!0,cover:!1},contentWidth:"600px",contentAlign:"center",fontFamily:{label:"Arial",value:"arial,helvetica,sans-serif"},preheaderText:"",linkStyle:{body:!0,linkColor:"#0000ee",linkHoverColor:"#0000ee",linkUnderline:!0,linkHoverUnderline:!0},_meta:{htmlID:"u_body"}}}}),C=async()=>{g(!0);try{let a=i.current?.editor;if(!a)return void b({title:"Error",description:"Editor not ready",variant:"destructive"});a.exportHtml(a=>{let{design:t,html:s}=a;e?.({name:d,subject:o,category:u,html_content:s,design_json:t,variables:v}),b({title:"Success!",description:"Email template saved successfully."})})}catch(e){console.error("Save failed:",e),b({title:"Error",description:"Failed to save template.",variant:"destructive"})}finally{g(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(s.Card,{className:"border-2",children:[(0,a.jsx)(s.CardHeader,{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-950 dark:to-pink-950",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:(0,a.jsx)(W,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(s.CardTitle,{className:"text-2xl",children:"Professional Email Builder"}),(0,a.jsx)(s.CardDescription,{children:"Drag & drop email editor with AI assistance - powered by Unlayer"})]})]}),(0,a.jsxs)(l.Button,{onClick:y,disabled:j,variant:"outline",size:"lg",children:[(0,a.jsx)(V.Sparkles,{className:"h-4 w-4 mr-2"}),j?"Generating...":"AI Generate"]})]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4 pt-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"name",children:"Template Name"}),(0,a.jsx)(D.Input,{id:"name",value:d,onChange:e=>c(e.target.value),placeholder:"Welcome Email"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"subject",children:"Subject Line"}),(0,a.jsx)(D.Input,{id:"subject",value:o,onChange:e=>m(e.target.value),placeholder:"Welcome to {{company}}, {{firstName}}!"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"category",children:"Category"}),(0,a.jsx)(D.Input,{id:"category",value:u,onChange:e=>h(e.target.value),placeholder:"Marketing"})]})]}),v.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(_.Label,{className:"text-sm font-semibold",children:"Variables:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:v.map(e=>(0,a.jsx)(x.Badge,{variant:"secondary",className:"text-xs",children:`{{${e}}}`},e))})]}),(0,a.jsx)("div",{className:"flex gap-3",children:(0,a.jsxs)(l.Button,{onClick:C,disabled:p||!d||!o,size:"lg",className:"flex-1",children:[(0,a.jsx)(F.Save,{className:"h-4 w-4 mr-2"}),p?"Saving...":"Save Template"]})})]})]}),(0,a.jsx)(s.Card,{className:"border-2",children:(0,a.jsx)(s.CardContent,{className:"p-0",children:(0,a.jsx)("div",{style:{height:"800px"},children:(0,a.jsx)(J,{ref:i,onReady:e=>{r?.design_json&&e.loadDesign(r.design_json)},options:{displayMode:"email",locale:"de-DE",appearance:{theme:"modern_light",panels:{tools:{dock:"left"}}},features:{textEditor:{tables:!0,emojis:!0}},tools:{form:{enabled:!0}},mergeTags:{firstName:{name:"First Name",value:"{{firstName}}"},lastName:{name:"Last Name",value:"{{lastName}}"},company:{name:"Company",value:"{{company}}"},jobTitle:{name:"Job Title",value:"{{jobTitle}}"},email:{name:"Email",value:"{{email}}"},ctaLink:{name:"CTA Link",value:"{{ctaLink}}"},unsubscribeLink:{name:"Unsubscribe Link",value:"{{unsubscribeLink}}"}}}})})})})]})}var G=e.i(841947),G=G;function X(){let[e,r]=(0,t.useState)([]),[n,i]=(0,t.useState)(null),[d,c]=(0,t.useState)(!1),[o,m]=(0,t.useState)({name:"",description:"",prompt:"",category:"email",variables:[]});(0,t.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=await fetch("/api/outreach/prompts");if(e.ok){let a=await e.json();r(a.prompts||[])}}catch(e){console.error("Failed to fetch prompts:",e)}},p=async()=>{try{let e=n?{...o,id:n}:o;(await fetch("/api/outreach/prompts",{method:n?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&(h(),j())}catch(e){console.error("Failed to save prompt:",e)}},g=async e=>{if(confirm("Delete this prompt?"))try{(await fetch(`/api/outreach/prompts?id=${e}`,{method:"DELETE"})).ok&&h()}catch(e){console.error("Failed to delete prompt:",e)}},j=()=>{m({name:"",description:"",prompt:"",category:"email",variables:[]}),i(null),c(!1)};return(0,t.useEffect)(()=>{let e,a=(e=o.prompt.match(/\{\{(\w+)\}\}/g))?[...new Set(e.map(e=>e.replace(/[{}]/g,"")))]:[];m(e=>({...e,variables:a}))},[o.prompt]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"AI Prompt Library"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Create and manage AI prompts for better email generation"})]}),!d&&(0,a.jsxs)(l.Button,{onClick:()=>c(!0),children:[(0,a.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"New Prompt"]})]}),d&&(0,a.jsxs)(s.Card,{className:"border-2 border-primary/20",children:[(0,a.jsx)(s.CardHeader,{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-950 dark:to-pink-950",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(V.Sparkles,{className:"h-5 w-5"}),n?"Edit Prompt":"Create New Prompt"]}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:j,children:(0,a.jsx)(G.default,{className:"h-4 w-4"})})]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4 pt-6",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"name",children:"Prompt Name"}),(0,a.jsx)(D.Input,{id:"name",value:o.name,onChange:e=>m({...o,name:e.target.value}),placeholder:"Cold Outreach Email"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"category",children:"Category"}),(0,a.jsxs)(L.Select,{value:o.category,onValueChange:e=>m({...o,category:e}),children:[(0,a.jsx)(L.SelectTrigger,{children:(0,a.jsx)(L.SelectValue,{})}),(0,a.jsxs)(L.SelectContent,{children:[(0,a.jsx)(L.SelectItem,{value:"email",children:"Email"}),(0,a.jsx)(L.SelectItem,{value:"sequence",children:"Sequence"}),(0,a.jsx)(L.SelectItem,{value:"campaign",children:"Campaign"}),(0,a.jsx)(L.SelectItem,{value:"follow-up",children:"Follow-up"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"description",children:"Description"}),(0,a.jsx)(D.Input,{id:"description",value:o.description,onChange:e=>m({...o,description:e.target.value}),placeholder:"Describe what this prompt does..."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"prompt",children:"Prompt Template"}),(0,a.jsx)(B.Textarea,{id:"prompt",value:o.prompt,onChange:e=>m({...o,prompt:e.target.value}),placeholder:"Create a professional email for {{targetAudience}} about {{topic}}...",rows:8}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Use ","{{variableName}}"," for dynamic values"]})]}),o.variables.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Detected Variables"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:o.variables.map(e=>(0,a.jsx)(x.Badge,{variant:"secondary",children:`{{${e}}}`},e))})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.Button,{onClick:p,className:"flex-1",children:[(0,a.jsx)(F.Save,{className:"h-4 w-4 mr-2"}),n?"Update":"Create"," Prompt"]}),(0,a.jsx)(l.Button,{variant:"outline",onClick:j,children:"Cancel"})]})]})]}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:e.map(e=>(0,a.jsxs)(s.Card,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(s.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(V.Sparkles,{className:"h-4 w-4 text-purple-500"}),e.name]}),(0,a.jsx)(s.CardDescription,{className:"mt-1",children:e.description})]}),(0,a.jsx)(x.Badge,{variant:"outline",children:e.category})]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-3 bg-muted/50 rounded-lg text-sm font-mono",children:[e.prompt.substring(0,150),e.prompt.length>150&&"..."]}),e.variables.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.variables.map(e=>(0,a.jsx)(x.Badge,{variant:"secondary",className:"text-xs",children:`{{${e}}}`},e))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>{i(e.id),m({name:e.name,description:e.description,prompt:e.prompt,category:e.category,variables:e.variables}),c(!0)},className:"flex-1",children:[(0,a.jsx)(A.Edit,{className:"h-3 w-3 mr-1"}),"Edit"]}),(0,a.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>g(e.id),children:(0,a.jsx)(v.Trash2,{className:"h-3 w-3"})})]})]})]},e.id))}),0===e.length&&!d&&(0,a.jsx)(s.Card,{className:"border-dashed",children:(0,a.jsxs)(s.CardContent,{className:"py-16 text-center",children:[(0,a.jsx)(V.Sparkles,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No prompts yet"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Create your first AI prompt to improve email generation"}),(0,a.jsxs)(l.Button,{onClick:()=>c(!0),children:[(0,a.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Create First Prompt"]})]})})]})}var Q=e.i(972520);let Y=(0,g.default)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);function Z({onSave:e,initialSequence:r}){let[i,d]=(0,t.useState)(r?.name||""),[c,o]=(0,t.useState)(r?.description||""),[m,x]=(0,t.useState)(r?.steps||[{id:"1",order:0,subject:"",content:"",delay_days:0}]),[p,g]=(0,t.useState)([]),[j,f]=(0,t.useState)(!1),[b,y]=(0,t.useState)(!1),{toast:N}=(0,w.useToast)();(0,t.useEffect)(()=>{C()},[]);let C=async()=>{try{let e=await fetch("/api/outreach/templates");if(e.ok){let a=await e.json();g(a.templates||[])}}catch(e){console.error("Failed to fetch templates:",e)}},k=async()=>{y(!0);try{let e=await (0,S.fetchWithCsrf)("/api/ai/generate-sequence",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({goal:i||"Lead nurturing sequence",targetAudience:"B2B decision makers",numberOfEmails:3,duration:"2 weeks",useKnowledgeBase:!0})});if(e.ok){let a=(await e.json()).emails.map((e,a)=>({id:String(a+1),order:a,subject:e.subject,content:e.content,delay_days:e.delayDays||3*a}));x(a),N({title:"AI Generated!",description:`${a.length} emails generated successfully.`})}}catch(e){console.error("AI generation failed:",e),N({title:"Error",description:"Failed to generate sequence",variant:"destructive"})}finally{y(!1)}},T=(e,a,t)=>{x(m.map(s=>s.id===e?{...s,[a]:t}:s))},E=async()=>{if(!i)return void N({title:"Validation Error",description:"Please enter a sequence name",variant:"destructive"});if(m.some(e=>!e.subject||!e.content))return void N({title:"Validation Error",description:"All steps must have subject and content",variant:"destructive"});f(!0);try{let a=r?.id?"PUT":"POST",t={...r?.id&&{id:r.id},name:i,description:c,steps:m.map(e=>({order:e.order,template_id:e.template_id,subject:e.subject,content:e.content,delay_days:e.delay_days}))},s=await (0,S.fetchWithCsrf)("/api/outreach/sequences",{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(s.ok){let a=await s.json();e?.(a.sequence),N({title:"Success!",description:"Sequence saved successfully"})}}catch(e){console.error("Save failed:",e),N({title:"Error",description:"Failed to save sequence",variant:"destructive"})}finally{f(!1)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(s.Card,{className:"border-2",children:[(0,a.jsx)(s.CardHeader,{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950 dark:to-purple-950",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center",children:(0,a.jsx)(n.Mail,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(s.CardTitle,{className:"text-2xl",children:"Email Sequence Builder"}),(0,a.jsx)(s.CardDescription,{children:"Create automated multi-step email sequences"})]})]}),(0,a.jsxs)(l.Button,{onClick:k,disabled:b,variant:"outline",size:"lg",children:[(0,a.jsx)(V.Sparkles,{className:"h-4 w-4 mr-2"}),b?"Generating...":"AI Generate"]})]})}),(0,a.jsx)(s.CardContent,{className:"space-y-4 pt-6",children:(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"name",children:"Sequence Name"}),(0,a.jsx)(D.Input,{id:"name",value:i,onChange:e=>d(e.target.value),placeholder:"Welcome Series"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"description",children:"Description"}),(0,a.jsx)(D.Input,{id:"description",value:c,onChange:e=>o(e.target.value),placeholder:"Onboarding sequence for new leads"})]})]})})]}),(0,a.jsx)("div",{className:"space-y-4",children:m.map((e,t)=>(0,a.jsxs)(s.Card,{className:"border-2 relative",children:[(0,a.jsx)(s.CardHeader,{className:"pb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:(0,a.jsx)("span",{className:"font-bold text-primary",children:t+1})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(s.CardTitle,{className:"text-lg",children:["Email ",t+1]}),(0,a.jsx)(s.CardDescription,{children:0===e.delay_days?"Sent immediately":`Sent ${e.delay_days} day${e.delay_days>1?"s":""} after ${0===t?"signup":"previous email"}`})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(Y,{className:"h-5 w-5 text-muted-foreground cursor-move"}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{var a;return a=e.id,void(1===m.length?N({title:"Cannot remove",description:"Sequence must have at least one step",variant:"destructive"}):x(m.filter(e=>e.id!==a).map((e,a)=>({...e,order:a}))))},disabled:1===m.length,children:(0,a.jsx)(v.Trash2,{className:"h-4 w-4 text-red-500"})})]})]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Delay (days)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.Clock,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)(D.Input,{type:"number",min:"0",value:e.delay_days,onChange:a=>T(e.id,"delay_days",parseInt(a.target.value)||0),className:"w-32"}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["days after ",0===t?"signup":"previous email"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Use Template (Optional)"}),(0,a.jsxs)(L.Select,{value:e.template_id||"",onValueChange:a=>{let t=p.find(e=>e.id===a);t&&(T(e.id,"template_id",a),T(e.id,"subject",t.subject),T(e.id,"content",t.content||""))},children:[(0,a.jsx)(L.SelectTrigger,{children:(0,a.jsx)(L.SelectValue,{placeholder:"Select a template..."})}),(0,a.jsx)(L.SelectContent,{children:p.map(e=>(0,a.jsx)(L.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Subject Line"}),(0,a.jsx)(D.Input,{value:e.subject,onChange:a=>T(e.id,"subject",a.target.value),placeholder:"Welcome to {{company}}, {{firstName}}!"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Email Content"}),(0,a.jsx)(B.Textarea,{value:e.content,onChange:a=>T(e.id,"content",a.target.value),placeholder:"Hi {{firstName}},  Welcome to our platform!...",rows:8})]})]}),t<m.length-1&&(0,a.jsx)("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2 z-10",children:(0,a.jsx)("div",{className:"bg-background border-2 rounded-full p-2",children:(0,a.jsx)(Q.ArrowRight,{className:"h-4 w-4 text-muted-foreground rotate-90"})})})]},e.id))}),(0,a.jsxs)(l.Button,{onClick:()=>{let e={id:String(Date.now()),order:m.length,subject:"",content:"",delay_days:3*(m.length>0)};x([...m,e])},variant:"outline",className:"w-full",size:"lg",children:[(0,a.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Add Email Step"]}),(0,a.jsx)(s.Card,{className:"border-2 bg-muted/50",children:(0,a.jsx)(s.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Sequence Summary"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m.length," email",m.length>1?"s":""," over ",Math.max(...m.map(e=>e.delay_days))," days"]})]}),(0,a.jsxs)(l.Button,{onClick:E,disabled:j||!i,size:"lg",children:[(0,a.jsx)(F.Save,{className:"h-4 w-4 mr-2"}),j?"Saving...":"Save Sequence"]})]})})})]})}var ee=e.i(569074),ea=e.i(178583),et=e.i(63209),G=G,es=e.i(510665);function el(){let[e,r]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[c,o]=(0,t.useState)(!1),[m,p]=(0,t.useState)(""),[g,j]=(0,t.useState)(!1),[f,b]=(0,t.useState)({name:"",description:"",file:null}),{toast:y}=(0,w.useToast)();(0,t.useEffect)(()=>{N()},[]);let N=async()=>{try{let e=await fetch("/api/outreach/knowledge-base");if(e.ok){let a=await e.json();r(a.knowledgeBases||[])}}catch(e){console.error("Failed to fetch knowledge bases:",e)}finally{i(!1)}},C=(0,t.useCallback)(e=>{e.length>0&&b(a=>({...a,file:e[0]}))},[]),{getRootProps:k,getInputProps:T,isDragActive:L}=(0,es.useDropzone)({onDrop:C,accept:{"application/pdf":[".pdf"],"application/msword":[".doc"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"text/plain":[".txt"],"text/markdown":[".md"]},maxFiles:1,multiple:!1}),E=async()=>{if(!f.name||!f.file)return void y({title:"Validation Error",description:"Please provide a name and file",variant:"destructive"});o(!0);try{let e=new FormData;if(e.append("file",f.file),e.append("name",f.name),e.append("description",f.description),(await (0,S.fetchWithCsrf)("/api/outreach/knowledge-base",{method:"POST",body:e})).ok)N(),j(!1),b({name:"",description:"",file:null}),y({title:"Success!",description:"Knowledge base uploaded successfully"});else throw Error("Upload failed")}catch(e){console.error("Upload failed:",e),y({title:"Error",description:"Failed to upload knowledge base",variant:"destructive"})}finally{o(!1)}},I=async a=>{if(confirm("Delete this knowledge base?"))try{(await (0,S.fetchWithCsrf)(`/api/outreach/knowledge-base?id=${a}`,{method:"DELETE"})).ok&&(r(e.filter(e=>e.id!==a)),y({title:"Success",description:"Knowledge base deleted successfully"}))}catch(e){console.error("Failed to delete:",e),y({title:"Error",description:"Failed to delete knowledge base",variant:"destructive"})}},F=e=>{if(!e)return"Unknown";let a=e/1048576;return a<1?`${(e/1024).toFixed(1)} KB`:`${a.toFixed(1)} MB`},P=e.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.description?.toLowerCase().includes(m.toLowerCase()));return n?(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,a.jsxs)(s.Card,{className:"animate-pulse",children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 mt-2"})]}),(0,a.jsx)(s.CardContent,{children:(0,a.jsx)("div",{className:"h-20 bg-gray-200 rounded"})})]},e))}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Knowledge Base"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Upload documents to help AI generate better emails"})]}),!g&&(0,a.jsxs)(l.Button,{onClick:()=>j(!0),children:[(0,a.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]}),g&&(0,a.jsxs)(s.Card,{className:"border-2 border-primary/20",children:[(0,a.jsxs)(s.CardHeader,{className:"bg-gradient-to-r from-primary/5 to-primary/10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(s.CardTitle,{children:"Upload Knowledge Base"}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{j(!1),b({name:"",description:"",file:null})},children:(0,a.jsx)(G.default,{className:"h-4 w-4"})})]}),(0,a.jsx)(s.CardDescription,{children:"Upload documents (PDF, DOC, TXT, MD) to enhance AI email generation"})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-4 pt-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"name",children:"Name"}),(0,a.jsx)(D.Input,{id:"name",value:f.name,onChange:e=>b({...f,name:e.target.value}),placeholder:"Company Overview"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{htmlFor:"description",children:"Description"}),(0,a.jsx)(B.Textarea,{id:"description",value:f.description,onChange:e=>b({...f,description:e.target.value}),placeholder:"Key information about our company, products, and values...",rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(_.Label,{children:"Document"}),(0,a.jsxs)("div",{...k(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors ${L?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"}`,children:[(0,a.jsx)("input",{...T()}),(0,a.jsx)(ee.Upload,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),f.file?(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:f.file.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:F(f.file.size)})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-1",children:L?"Drop file here":"Drag & drop or click to upload"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"PDF, DOC, DOCX, TXT, MD (max 10MB)"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.Button,{onClick:E,disabled:c||!f.name||!f.file,className:"flex-1",children:[(0,a.jsx)(ee.Upload,{className:"h-4 w-4 mr-2"}),c?"Uploading...":"Upload"]}),(0,a.jsx)(l.Button,{variant:"outline",onClick:()=>{j(!1),b({name:"",description:"",file:null})},children:"Cancel"})]})]})]}),e.length>0&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(H.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(D.Input,{placeholder:"Search knowledge bases...",value:m,onChange:e=>p(e.target.value),className:"pl-10"})]}),0===e.length?(0,a.jsx)(s.Card,{className:"border-dashed",children:(0,a.jsxs)(s.CardContent,{className:"py-16 text-center",children:[(0,a.jsx)(ea.FileText,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No knowledge bases yet"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-6",children:"Upload documents to help AI generate more personalized emails"}),(0,a.jsxs)(l.Button,{onClick:()=>j(!0),children:[(0,a.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Upload First Document"]})]})}):(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:P.map(e=>(0,a.jsxs)(s.Card,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(ea.FileText,{className:"h-4 w-4 text-primary"}),(0,a.jsxs)(x.Badge,{className:(e=>{switch(e){case"ready":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"processing":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";default:return""}})(e.status),children:[(e=>{switch(e){case"ready":return(0,a.jsx)(d.CheckCircle,{className:"h-4 w-4 text-green-500"});case"processing":return(0,a.jsx)(h.Clock,{className:"h-4 w-4 text-yellow-500 animate-spin"});case"error":return(0,a.jsx)(et.AlertCircle,{className:"h-4 w-4 text-red-500"});default:return null}})(e.status),(0,a.jsx)("span",{className:"ml-1",children:e.status})]})]}),(0,a.jsx)(s.CardTitle,{className:"text-lg line-clamp-1",children:e.name}),(0,a.jsx)(s.CardDescription,{className:"line-clamp-2 mt-1",children:e.description||"No description"})]}),(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>I(e.id),children:(0,a.jsx)(v.Trash2,{className:"h-4 w-4 text-red-500"})})]})}),(0,a.jsx)(s.CardContent,{children:(0,a.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Type:"}),(0,a.jsx)("span",{className:"font-medium",children:e.file_type?.toUpperCase()||"Unknown"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Size:"}),(0,a.jsx)("span",{className:"font-medium",children:F(e.file_size)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Uploaded:"}),(0,a.jsx)("span",{className:"font-medium",children:new Date(e.created_at).toLocaleDateString("de-DE",{day:"2-digit",month:"short"})})]})]})})]},e.id))}),0===P.length&&m&&(0,a.jsx)(s.Card,{className:"border-dashed",children:(0,a.jsxs)(s.CardContent,{className:"py-12 text-center",children:[(0,a.jsx)(H.Search,{className:"h-8 w-8 text-muted-foreground mx-auto mb-3"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:['No knowledge bases found for "',m,'"']})]})})]})}function er(){let[e,x]=(0,t.useState)("campaigns"),[h,p]=(0,t.useState)(!1),[g,j]=(0,t.useState)(!1),[f,b]=(0,t.useState)(null),[v,y]=(0,t.useState)(!1),[N,C]=(0,t.useState)(null),[w,k]=(0,t.useState)(!1),[S,T]=(0,t.useState)(!1),[D,_]=(0,t.useState)({totalSent:0,totalDelivered:0,totalOpened:0,totalClicked:0,totalConverted:0,activeCampaigns:0});(0,t.useEffect)(()=>{L()},[]);let L=async()=>{try{let e=await fetch("/api/outreach/analytics?timeRange=30d");if(e.ok){let a=await e.json();_({totalSent:a.analytics.summary.totalSent||0,totalDelivered:a.analytics.summary.totalDelivered||0,totalOpened:a.analytics.summary.totalOpened||0,totalClicked:a.analytics.summary.totalClicked||0,totalConverted:a.analytics.summary.totalConverted||0,activeCampaigns:a.analytics.topCampaigns?.filter(e=>"active"===e.status).length||0})}}catch(e){console.error("Failed to fetch stats:",e)}},B=(e,a)=>0===a?"0.0":(e/a*100).toFixed(1);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Outreach Campaigns"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage your email marketing campaigns and outreach sequences"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.Button,{variant:"outline",onClick:()=>x("analytics"),children:[(0,a.jsx)(m.BarChart3,{className:"h-4 w-4 mr-2"}),"Analytics"]}),(0,a.jsxs)(l.Button,{onClick:()=>p(!0),children:[(0,a.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-6",children:[(0,a.jsxs)(s.Card,{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900 border-blue-200 dark:border-blue-800",children:[(0,a.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(s.CardTitle,{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:"Total Sent"}),(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-500/20 flex items-center justify-center",children:(0,a.jsx)(i.Send,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})})]}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-900 dark:text-blue-100",children:D.totalSent}),(0,a.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:"Total emails sent"})]})]}),(0,a.jsxs)(s.Card,{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900 border-green-200 dark:border-green-800",children:[(0,a.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(s.CardTitle,{className:"text-sm font-medium text-green-900 dark:text-green-100",children:"Delivered"}),(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-green-500/20 flex items-center justify-center",children:(0,a.jsx)(d.CheckCircle,{className:"h-4 w-4 text-green-600 dark:text-green-400"})})]}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-green-900 dark:text-green-100",children:D.totalDelivered}),(0,a.jsxs)("p",{className:"text-xs text-green-700 dark:text-green-300 mt-1",children:[B(D.totalDelivered,D.totalSent),"% delivery rate"]})]})]}),(0,a.jsxs)(s.Card,{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900 border-purple-200 dark:border-purple-800",children:[(0,a.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(s.CardTitle,{className:"text-sm font-medium text-purple-900 dark:text-purple-100",children:"Opened"}),(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-purple-500/20 flex items-center justify-center",children:(0,a.jsx)(n.Mail,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})})]}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-purple-900 dark:text-purple-100",children:D.totalOpened}),(0,a.jsxs)("p",{className:"text-xs text-purple-700 dark:text-purple-300 mt-1",children:[B(D.totalOpened,D.totalDelivered),"% open rate"]})]})]}),(0,a.jsxs)(s.Card,{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-950 dark:to-orange-900 border-orange-200 dark:border-orange-800",children:[(0,a.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(s.CardTitle,{className:"text-sm font-medium text-orange-900 dark:text-orange-100",children:"Clicked"}),(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-orange-500/20 flex items-center justify-center",children:(0,a.jsx)(c.Target,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"})})]}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-orange-900 dark:text-orange-100",children:D.totalClicked}),(0,a.jsxs)("p",{className:"text-xs text-orange-700 dark:text-orange-300 mt-1",children:[B(D.totalClicked,D.totalOpened),"% click rate"]})]})]}),(0,a.jsxs)(s.Card,{className:"bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-950 dark:to-pink-900 border-pink-200 dark:border-pink-800",children:[(0,a.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(s.CardTitle,{className:"text-sm font-medium text-pink-900 dark:text-pink-100",children:"Converted"}),(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-pink-500/20 flex items-center justify-center",children:(0,a.jsx)(o.Users,{className:"h-4 w-4 text-pink-600 dark:text-pink-400"})})]}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-pink-900 dark:text-pink-100",children:D.totalConverted}),(0,a.jsxs)("p",{className:"text-xs text-pink-700 dark:text-pink-300 mt-1",children:[B(D.totalConverted,D.totalClicked),"% conversion"]})]})]}),(0,a.jsxs)(s.Card,{className:"bg-gradient-to-br from-indigo-50 to-indigo-100 dark:from-indigo-950 dark:to-indigo-900 border-indigo-200 dark:border-indigo-800",children:[(0,a.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(s.CardTitle,{className:"text-sm font-medium text-indigo-900 dark:text-indigo-100",children:"Active"}),(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-indigo-500/20 flex items-center justify-center",children:(0,a.jsx)(i.Send,{className:"h-4 w-4 text-indigo-600 dark:text-indigo-400"})})]}),(0,a.jsxs)(s.CardContent,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-indigo-900 dark:text-indigo-100",children:D.activeCampaigns}),(0,a.jsx)("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 mt-1",children:"Running campaigns"})]})]})]}),(0,a.jsxs)(r.Tabs,{value:e,onValueChange:x,className:"space-y-6",children:[(0,a.jsxs)(r.TabsList,{className:"grid w-full grid-cols-7",children:[(0,a.jsx)(r.TabsTrigger,{value:"campaigns",children:"Campaigns"}),(0,a.jsx)(r.TabsTrigger,{value:"templates",children:"Templates"}),(0,a.jsx)(r.TabsTrigger,{value:"email-builder",children:"Email Builder"}),(0,a.jsx)(r.TabsTrigger,{value:"ai-prompts",children:"AI Prompts"}),(0,a.jsx)(r.TabsTrigger,{value:"sequences",children:"Sequences"}),(0,a.jsx)(r.TabsTrigger,{value:"knowledge-base",children:"Knowledge Base"}),(0,a.jsx)(r.TabsTrigger,{value:"analytics",children:"Analytics"})]}),(0,a.jsx)(r.TabsContent,{value:"campaigns",className:"space-y-6",children:(0,a.jsx)(E,{})}),(0,a.jsx)(r.TabsContent,{value:"templates",className:"space-y-6",children:v?(0,a.jsx)(O,{initialTemplate:N,onSave:()=>{y(!1),C(null)}}):(0,a.jsx)(U,{onEdit:e=>{C(e),y(!0)},onSelect:e=>{C(e),y(!0)}})}),(0,a.jsx)(r.TabsContent,{value:"email-builder",className:"space-y-6",children:(0,a.jsx)(K,{onSave:e=>{console.log("Template saved:",e)}})}),(0,a.jsx)(r.TabsContent,{value:"ai-prompts",className:"space-y-6",children:(0,a.jsx)(X,{})}),(0,a.jsx)(r.TabsContent,{value:"sequences",className:"space-y-6",children:(0,a.jsx)(Z,{onSave:e=>{console.log("Sequence saved:",e),T(!1)}})}),(0,a.jsx)(r.TabsContent,{value:"knowledge-base",className:"space-y-6",children:(0,a.jsx)(el,{})}),(0,a.jsx)(r.TabsContent,{value:"analytics",className:"space-y-6",children:(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsx)(s.CardTitle,{children:"Campaign Analytics"}),(0,a.jsx)(s.CardDescription,{children:"Detailed performance metrics and insights"})]}),(0,a.jsx)(s.CardContent,{children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Analytics dashboard coming soon..."})})]})})]}),(0,a.jsx)(I,{open:h,onOpenChange:p,onSuccess:()=>{L()}}),f&&(0,a.jsx)(q,{open:g,onOpenChange:j,campaignId:f.id,templateId:f.template_id,onSuccess:()=>{L()}})]})}e.s(["default",()=>er],752339)}]);