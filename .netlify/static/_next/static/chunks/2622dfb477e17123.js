(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,686311,e=>{"use strict";let s=(0,e.i(475254).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);e.s(["MessageSquare",()=>s],686311)},496665,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(970065),l=e.i(167881),r=e.i(184762),i=e.i(994179),n=e.i(62870),c=e.i(319036),d=e.i(10708),o=e.i(514764),m=e.i(531245),x=e.i(475254);let h=(0,x.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var u=e.i(174886),j=e.i(643531),p=e.i(283086),g=e.i(455711),f=e.i(39312),N=e.i(495242);let v=(0,x.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var y=e.i(686311),C=e.i(503116),w=e.i(846696);function b({className:e,initialContext:x="general",leadData:b,campaignData:S}){let k,_,T,[D,A]=(0,a.useState)([]),[I,P]=(0,a.useState)(""),[B,F]=(0,a.useState)(!1),[z,E]=(0,a.useState)(!1),[L,R]=(0,a.useState)(x),[M,H]=(0,a.useState)(null),[O,$]=(0,a.useState)(""),[U,V]=(0,a.useState)(!0),[W,q]=(0,a.useState)(!0),[Y,J]=(0,a.useState)("balanced"),Z=(0,a.useRef)(null),K=(0,a.useRef)(null);(0,a.useEffect)(()=>{Z.current?.scrollIntoView({behavior:"smooth"})},[D,O]);let G=[{value:"general",label:"General",icon:m.Bot,color:"bg-blue-500"},{value:"leads",label:"Lead Expert",icon:g.Brain,color:"bg-green-500"},{value:"campaigns",label:"Campaign Specialist",icon:y.MessageSquare,color:"bg-purple-500"},{value:"analytics",label:"Data Analyst",icon:f.Zap,color:"bg-orange-500"}],Q=async()=>{if(!I.trim()||B)return;let e={id:Date.now().toString(),role:"user",content:I.trim(),timestamp:new Date().toISOString(),context:L};A(s=>[...s,e]),P(""),F(!0),E(!0),$(""),K.current=new AbortController;try{let s=await fetch("/api/ai/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:U?[...D.slice(-6),e]:[e],leadData:W?b:null,campaignData:W?S:null}),signal:K.current.signal});if(!s.ok)throw Error("Failed to start streaming");let a=s.body?.getReader(),t=new TextDecoder;if(!a)throw Error("No response body");let l="";for(;;){let{done:e,value:s}=await a.read();if(e)break;for(let e of t.decode(s).split("\n"))if(e.startsWith("data: ")){let s=e.slice(6);if("[DONE]"===s){E(!1);let e={id:(Date.now()+1).toString(),role:"assistant",content:l,timestamp:new Date().toISOString(),context:L,isStreaming:!1};A(s=>[...s,e]),$("");break}try{let e=JSON.parse(s);e.content&&(l+=e.content,$(l))}catch(e){}}}}catch(e){if("AbortError"===e.name)w.toast.info("Response stopped by user");else{console.error("Streaming error:",e),w.toast.error("Failed to get response. Please try again.");let s={id:(Date.now()+1).toString(),role:"assistant",content:"I apologize, but I encountered an error. Please try again.",timestamp:new Date().toISOString()};A(e=>[...e,s])}}finally{F(!1),E(!1),$(""),K.current=null}},X=async(e,s)=>{try{await navigator.clipboard.writeText(s),H(e),w.toast.success("Message copied to clipboard"),setTimeout(()=>H(null),2e3)}catch(e){w.toast.error("Failed to copy message")}},ee=e=>{let s=G.find(s=>s.value===e);return s?.icon||m.Bot},es=e=>{let s=G.find(s=>s.value===e);return s?.color||"bg-blue-500"};return(0,s.jsxs)("div",{className:`flex flex-col h-full ${e}`,children:[(0,s.jsxs)(t.CardHeader,{className:"pb-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`p-2 rounded-lg ${es(L)}`,children:(0,s.jsx)(p.Sparkles,{className:"h-4 w-4 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(t.CardTitle,{className:"text-lg flex items-center gap-2",children:["Emex AI Assistant",z&&(0,s.jsxs)(i.Badge,{variant:"outline",className:"text-xs animate-pulse",children:[(0,s.jsx)(f.Zap,{className:"h-3 w-3 mr-1"}),"Streaming"]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"GPT-4 Turbo with Streaming"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(n.Select,{value:L,onValueChange:R,children:[(0,s.jsx)(n.SelectTrigger,{className:"w-32",children:(0,s.jsx)(n.SelectValue,{})}),(0,s.jsx)(n.SelectContent,{children:G.map(e=>{let a=e.icon;return(0,s.jsx)(n.SelectItem,{value:e.value,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:e.label})]})},e.value)})})]}),(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>{A([]),$(""),w.toast.success("Conversation cleared")},disabled:B,children:(0,s.jsx)(v,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-4 mt-3 p-3 bg-muted/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(c.Switch,{id:"memory",checked:U,onCheckedChange:V,disabled:B}),(0,s.jsx)(d.Label,{htmlFor:"memory",className:"text-sm",children:"Memory"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(c.Switch,{id:"personalization",checked:W,onCheckedChange:q,disabled:B}),(0,s.jsx)(d.Label,{htmlFor:"personalization",className:"text-sm",children:"Personalization"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.Label,{className:"text-sm",children:"Speed:"}),(0,s.jsxs)(n.Select,{value:Y,onValueChange:e=>J(e),children:[(0,s.jsx)(n.SelectTrigger,{className:"w-24 h-7",children:(0,s.jsx)(n.SelectValue,{})}),(0,s.jsxs)(n.SelectContent,{children:[(0,s.jsx)(n.SelectItem,{value:"fast",children:"Fast"}),(0,s.jsx)(n.SelectItem,{value:"balanced",children:"Balanced"}),(0,s.jsx)(n.SelectItem,{value:"thoughtful",children:"Thoughtful"})]})]})]})]}),(b||S)&&(0,s.jsxs)("div",{className:"flex gap-2 mt-2",children:[b&&(0,s.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:[(0,s.jsx)(g.Brain,{className:"h-3 w-3 mr-1"}),"Lead Context"]}),S&&(0,s.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:[(0,s.jsx)(y.MessageSquare,{className:"h-3 w-3 mr-1"}),"Campaign Context"]})]})]}),(0,s.jsx)(t.CardContent,{className:"flex-1 overflow-hidden p-0",children:(0,s.jsxs)("div",{className:"h-full overflow-y-auto px-6 pb-4",children:[0!==D.length||z?(0,s.jsxs)("div",{className:"space-y-4",children:[D.map(e=>{let a="user"===e.role,t=ee(e.context||L);return(0,s.jsxs)("div",{className:`flex gap-3 ${a?"justify-end":"justify-start"}`,children:[!a&&(0,s.jsx)("div",{className:`p-2 rounded-full ${es(e.context||L)} flex-shrink-0`,children:(0,s.jsx)(t,{className:"h-4 w-4 text-white"})}),(0,s.jsxs)("div",{className:`max-w-[80%] ${a?"order-first":""}`,children:[(0,s.jsx)("div",{className:`rounded-2xl px-4 py-3 ${a?"bg-primary text-primary-foreground ml-auto":"bg-muted"}`,children:(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1 px-2",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),!a&&(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>X(e.id,e.content),children:M===e.id?(0,s.jsx)(j.Check,{className:"h-3 w-3"}):(0,s.jsx)(u.Copy,{className:"h-3 w-3"})})]})]}),a&&(0,s.jsx)("div",{className:"p-2 rounded-full bg-primary flex-shrink-0 order-first",children:(0,s.jsx)(h,{className:"h-4 w-4 text-primary-foreground"})})]},e.id)}),z&&O&&(0,s.jsxs)("div",{className:"flex gap-3 justify-start",children:[(0,s.jsx)("div",{className:`p-2 rounded-full ${es(L)} flex-shrink-0`,children:(k=ee(L),(0,s.jsx)(k,{className:"h-4 w-4 text-white"}))}),(0,s.jsx)("div",{className:"bg-muted rounded-2xl px-4 py-3 max-w-[80%]",children:(0,s.jsxs)("p",{className:"text-sm whitespace-pre-wrap",children:[O,(0,s.jsx)("span",{className:"inline-block w-2 h-4 bg-muted-foreground animate-pulse ml-1"})]})})]}),z&&!O&&(0,s.jsxs)("div",{className:"flex gap-3 justify-start",children:[(0,s.jsx)("div",{className:`p-2 rounded-full ${es(L)} flex-shrink-0`,children:(_=ee(L),(0,s.jsx)(_,{className:"h-4 w-4 text-white"}))}),(0,s.jsx)("div",{className:"bg-muted rounded-2xl px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,s.jsx)("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Thinking..."})]})})]})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[(0,s.jsx)("div",{className:`p-4 rounded-full ${es(L)} mb-4`,children:(T=ee(L),(0,s.jsx)(T,{className:"h-8 w-8 text-white"}))}),(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Advanced AI Assistant"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground max-w-md mb-4",children:"Powered by GPT-4 Turbo with streaming responses, memory, and personalization."}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-2 w-full max-w-sm",children:[(0,s.jsx)(l.Button,{variant:"outline",size:"sm",className:"justify-start text-left h-auto p-3",onClick:()=>P("Analyze my recent lead generation performance and suggest improvements"),children:"ðŸ“Š Analyze my performance and suggest improvements"}),(0,s.jsx)(l.Button,{variant:"outline",size:"sm",className:"justify-start text-left h-auto p-3",onClick:()=>P("Help me create a personalized outreach strategy"),children:"ðŸŽ¯ Create a personalized outreach strategy"})]})]}),(0,s.jsx)("div",{ref:Z})]})}),(0,s.jsxs)("div",{className:"p-4 border-t",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(r.Textarea,{value:I,onChange:e=>P(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Q())},placeholder:"Ask anything about your lead generation strategy...",className:"min-h-[60px] resize-none",disabled:B}),(0,s.jsx)("div",{className:"flex flex-col gap-1",children:z?(0,s.jsx)(l.Button,{onClick:()=>{K.current&&K.current.abort()},size:"sm",variant:"destructive",children:(0,s.jsx)(N.Pause,{className:"h-4 w-4"})}):(0,s.jsx)(l.Button,{onClick:Q,disabled:!I.trim()||B,size:"sm",children:B?(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):(0,s.jsx)(o.Send,{className:"h-4 w-4"})})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:z?"Streaming response...":"Press Enter to send, Shift+Enter for new line"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[U&&(0,s.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:[(0,s.jsx)(C.Clock,{className:"h-3 w-3 mr-1"}),"Memory On"]}),W&&(0,s.jsxs)(i.Badge,{variant:"outline",className:"text-xs",children:[(0,s.jsx)(g.Brain,{className:"h-3 w-3 mr-1"}),"Personalized"]})]})]})]})]})}e.s(["StreamingAIAssistant",()=>b],496665)},995461,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(970065),l=e.i(167881),r=e.i(62870),i=e.i(994179),n=e.i(287336),c=e.i(25652),d=e.i(635408),o=e.i(761911),m=e.i(263488),x=e.i(620278),h=e.i(217923),u=e.i(16715),j=e.i(21218),p=e.i(286536);function g({className:e}){let[g,f]=(0,a.useState)(null),[N,v]=(0,a.useState)(!0),[y,C]=(0,a.useState)("30d"),[w,b]=(0,a.useState)(!1),[S,k]=(0,a.useState)(null);(0,a.useEffect)(()=>{_()},[y]);let _=async()=>{try{v(!0),k(null);let e=await fetch(`/api/analytics?timeRange=${y}&type=overview`);if(!e.ok)return void(503===e.status?k("Service unavailable: Supabase not configured. Set SUPABASE_SERVICE_ROLE_KEY and restart the server."):401===e.status?k("Unauthorized: Please sign in to view analytics."):k("Failed to fetch analytics"));let s=await e.json();f(s.analytics)}catch(e){console.error("Fetch analytics error:",e),k("Failed to fetch analytics")}finally{v(!1)}},T=async()=>{b(!0),await _(),b(!1)};return N?(0,s.jsx)("div",{className:e,children:(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[void 0,void 0,void 0,void 0].map((e,a)=>(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)("div",{className:"h-4 w-20 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-4 w-4 bg-muted animate-pulse rounded"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"h-8 w-16 bg-muted animate-pulse rounded mb-2"}),(0,s.jsx)("div",{className:"h-3 w-24 bg-muted animate-pulse rounded"})]})]},a))})}):S?(0,s.jsx)("div",{className:e,children:(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Analytics Unavailable"}),(0,s.jsx)(t.CardDescription,{children:S})]}),(0,s.jsxs)(t.CardContent,{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Please configure the environment and try again."}),(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:T,disabled:w,children:(0,s.jsx)(u.RefreshCw,{className:`h-4 w-4 ${w?"animate-spin":""}`})})]})]})}):g?(0,s.jsxs)("div",{className:e,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Analytics Overview"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Real-time performance metrics for your lead generation"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(r.Select,{value:y,onValueChange:C,children:[(0,s.jsx)(r.SelectTrigger,{className:"w-[120px]",children:(0,s.jsx)(r.SelectValue,{})}),(0,s.jsxs)(r.SelectContent,{children:[(0,s.jsx)(r.SelectItem,{value:"7d",children:"Last 7 days"}),(0,s.jsx)(r.SelectItem,{value:"30d",children:"Last 30 days"}),(0,s.jsx)(r.SelectItem,{value:"90d",children:"Last 90 days"})]})]}),(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:T,disabled:w,children:(0,s.jsx)(u.RefreshCw,{className:`h-4 w-4 ${w?"animate-spin":""}`})})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Total Leads"}),(0,s.jsx)(o.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:g.leads.total.toLocaleString()}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs",children:[g.leads.growth.startsWith("+")?(0,s.jsx)(c.TrendingUp,{className:"h-4 w-4 text-green-500"}):(0,s.jsx)(d.TrendingDown,{className:"h-4 w-4 text-red-500"}),(0,s.jsx)("span",{className:g.leads.growth.startsWith("+")?"text-green-600":"text-red-600",children:g.leads.growth}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"from last period"})]})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Outreach Ready"}),(0,s.jsx)(x.Target,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:g.leads.outreachReady.toLocaleString()}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,s.jsxs)("span",{children:[Math.round(g.leads.outreachReady/g.leads.total*100),"%"]}),(0,s.jsx)("span",{children:"of total leads"})]})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Emails Sent"}),(0,s.jsx)(m.Mail,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:g.campaigns.sent.toLocaleString()}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:(0,s.jsxs)("span",{children:["across ",g.campaigns.total," campaigns"]})})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Open Rate"}),(0,s.jsx)(p.Eye,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[g.campaigns.openRate,"%"]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:(0,s.jsxs)("span",{children:[g.campaigns.opened.toLocaleString()," opens"]})})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(j.Activity,{className:"h-5 w-5"}),"Lead Quality"]}),(0,s.jsx)(t.CardDescription,{children:"Quality metrics for your leads"})]}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Valid Emails"}),(0,s.jsx)("span",{className:"font-medium",children:g.leads.validEmails})]}),(0,s.jsx)(n.Progress,{value:g.leads.validEmails/g.leads.total*100,className:"h-2"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Average Score"}),(0,s.jsxs)("span",{className:"font-medium",children:[g.leads.avgScore,"/100"]})]}),(0,s.jsx)(n.Progress,{value:g.leads.avgScore,className:"h-2"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Outreach Ready"}),(0,s.jsx)("span",{className:"font-medium",children:g.leads.outreachReady})]}),(0,s.jsx)(n.Progress,{value:g.leads.outreachReady/g.leads.total*100,className:"h-2"})]})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(h.BarChart3,{className:"h-5 w-5"}),"Campaign Performance"]}),(0,s.jsx)(t.CardDescription,{children:"Email campaign metrics"})]}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:g.campaigns.active}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active Campaigns"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:g.campaigns.total}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Campaigns"})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Open Rate"}),(0,s.jsxs)(i.Badge,{variant:"outline",children:[g.campaigns.openRate,"%"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Emails Opened"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:g.campaigns.opened.toLocaleString()})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Total Sent"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:g.campaigns.sent.toLocaleString()})]})]})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Target,{className:"h-5 w-5"}),"Content Library"]}),(0,s.jsx)(t.CardDescription,{children:"Your marketing assets"})]}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:g.content.templates}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Email Templates"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:g.content.knowledgeBases}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Knowledge Bases"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,s.jsx)("span",{children:"Templates ready for use"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,s.jsx)("span",{children:"AI-powered content"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),(0,s.jsx)("span",{children:"Personalization assets"})]})]}),(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(l.Button,{variant:"outline",size:"sm",className:"w-full",children:"View All Content"})})]})]})]})]}):(0,s.jsx)("div",{className:e,children:(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center justify-center h-32",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No analytics data available"})})})})}e.s(["RealAnalytics",()=>g])},578138,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(970065),l=e.i(167881),r=e.i(62870),i=e.i(994179),n=e.i(287336),c=e.i(455711),d=e.i(686311),o=e.i(25652),m=e.i(39312),x=e.i(217923),h=e.i(16715),u=e.i(21218),j=e.i(761911),p=e.i(620278);let g=(0,e.i(475254).default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);var f=e.i(846696);function N({className:e}){let[N,v]=(0,a.useState)(null),[y,C]=(0,a.useState)(!0),[w,b]=(0,a.useState)("30d"),[S,k]=(0,a.useState)(!1);(0,a.useEffect)(()=>{_()},[w]);let _=async()=>{try{C(!0);let e=await fetch(`/api/ai/analytics?timeRange=${w}`);if(!e.ok)throw Error("Failed to fetch AI analytics");let s=await e.json();v(s.analytics)}catch(e){console.error("Fetch AI analytics error:",e),f.toast.error("Failed to load AI analytics")}finally{C(!1)}},T=async()=>{k(!0),await _(),k(!1)};return y?(0,s.jsx)("div",{className:e,children:(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[void 0,void 0,void 0,void 0].map((e,a)=>(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)("div",{className:"h-4 w-20 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-4 w-4 bg-muted animate-pulse rounded"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"h-8 w-16 bg-muted animate-pulse rounded mb-2"}),(0,s.jsx)("div",{className:"h-3 w-24 bg-muted animate-pulse rounded"})]})]},a))})}):N?(0,s.jsxs)("div",{className:e,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"AI Assistant Analytics"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Performance metrics and usage insights for your AI assistant"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(r.Select,{value:w,onValueChange:b,children:[(0,s.jsx)(r.SelectTrigger,{className:"w-[120px]",children:(0,s.jsx)(r.SelectValue,{})}),(0,s.jsxs)(r.SelectContent,{children:[(0,s.jsx)(r.SelectItem,{value:"7d",children:"Last 7 days"}),(0,s.jsx)(r.SelectItem,{value:"30d",children:"Last 30 days"}),(0,s.jsx)(r.SelectItem,{value:"90d",children:"Last 90 days"})]})]}),(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:T,disabled:S,children:(0,s.jsx)(h.RefreshCw,{className:`h-4 w-4 ${S?"animate-spin":""}`})})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Total Conversations"}),(0,s.jsx)(d.MessageSquare,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:N.overview.totalConversations.toLocaleString()}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:(0,s.jsxs)("span",{children:["Avg ",N.usage.avgTokensPerConversation," tokens per conversation"]})})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Tokens Used"}),(0,s.jsx)(m.Zap,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:N.overview.totalTokensUsed.toLocaleString()}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:(0,s.jsx)("span",{children:"Across all conversations"})})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"AI Insights"}),(0,s.jsx)(g,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:N.overview.totalInsights}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs",children:(0,s.jsxs)(i.Badge,{variant:"outline",className:"text-green-600",children:[N.overview.implementationRate,"% implemented"]})})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:"Avg Confidence"}),(0,s.jsx)(u.Activity,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[N.insights.avgConfidence.toFixed(1),"%"]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:(0,s.jsx)("span",{children:"AI response confidence"})})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Brain,{className:"h-5 w-5"}),"Conversation Context Distribution"]}),(0,s.jsx)(t.CardDescription,{children:"AI assistant usage by context"})]}),(0,s.jsx)(t.CardContent,{className:"space-y-4",children:Object.entries(N.usage.contextDistribution).map(([e,a])=>{let t=(e=>{switch(e){case"leads":return j.Users;case"campaigns":return p.Target;case"analytics":return x.BarChart3;case"technical":return c.Brain;default:return d.MessageSquare}})(e),l=a/N.overview.totalConversations*100;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`p-1 rounded ${(e=>{switch(e){case"leads":return"bg-green-500";case"campaigns":return"bg-purple-500";case"analytics":return"bg-orange-500";case"technical":return"bg-red-500";default:return"bg-blue-500"}})(e)}`,children:(0,s.jsx)(t,{className:"h-3 w-3 text-white"})}),(0,s.jsx)("span",{className:"capitalize",children:e})]}),(0,s.jsx)("span",{className:"font-medium",children:a})]}),(0,s.jsx)(n.Progress,{value:l,className:"h-2"})]},e)})})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(x.BarChart3,{className:"h-5 w-5"}),"AI Feature Usage"]}),(0,s.jsx)(t.CardDescription,{children:"Usage of different AI features"})]}),(0,s.jsx)(t.CardContent,{className:"space-y-4",children:Object.entries(N.usage.aiTypeDistribution).map(([e,a])=>{let t=a/Object.values(N.usage.aiTypeDistribution).reduce((e,s)=>e+s,0)*100;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"capitalize",children:e.replace("_"," ")}),(0,s.jsx)("span",{className:"font-medium",children:a})]}),(0,s.jsx)(n.Progress,{value:t,className:"h-2"})]},e)})})]})]}),(0,s.jsxs)(t.Card,{className:"mt-6",children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(o.TrendingUp,{className:"h-5 w-5"}),"AI Insights Distribution"]}),(0,s.jsx)(t.CardDescription,{children:"Types of insights generated by AI"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(N.insights.distribution).map(([e,a])=>(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:a}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground capitalize",children:e.replace("_"," ")})]},e))})})]})]}):(0,s.jsx)("div",{className:e,children:(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"flex items-center justify-center h-32",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"No AI analytics data available"})})})})}e.s(["AIAnalytics",()=>N],578138)},212426,e=>{"use strict";let s=(0,e.i(475254).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>s],212426)},933703,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(970065),l=e.i(167881),r=e.i(994179),i=e.i(647163);let n=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full bg-muted",e),...a}));n.displayName="Avatar",a.forwardRef(({className:e,...a},t)=>(0,s.jsx)("img",{ref:t,className:(0,i.cn)("aspect-square h-full w-full object-cover",e),...a})).displayName="AvatarImage";let c=a.forwardRef(({className:e,...a},t)=>(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted text-muted-foreground text-sm font-medium",e),...a}));c.displayName="AvatarFallback";var d=e.i(107233),o=e.i(212426),m=e.i(25652),x=e.i(87316),h=e.i(620278),u=e.i(687130),j=e.i(555436);let p=(0,e.i(475254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var g=e.i(688511),f=e.i(727612),N=e.i(23750),v=e.i(463415),y=e.i(174117),C=e.i(630374),w=e.i(10708),b=e.i(184762),S=e.i(62870),k=e.i(87446);function _(){let[e,i]=(0,a.useState)([]),[_,T]=(0,a.useState)([]),[D,A]=(0,a.useState)(!0),[I,P]=(0,a.useState)(""),[B,F]=(0,a.useState)(""),[z,E]=(0,a.useState)(!1),[L,R]=(0,a.useState)({title:"",company_name:"",contact_name:"",contact_email:"",deal_value:"",expected_close_date:"",priority:"medium",notes:""}),{toast:M}=(0,y.useToast)();(0,a.useEffect)(()=>{H()},[]);let H=async()=>{try{let[e,s]=await Promise.all([fetch("/api/sales/deal-stages"),fetch("/api/sales/deals")]),a=await e.json(),t=await s.json();if((!a.stages||0===a.stages.length)&&(console.log("No deal stages found, setting up defaults..."),(await (0,k.fetchWithCsrf)("/api/setup/deal-stages",{method:"POST"})).ok)){let e=await fetch("/api/sales/deal-stages");a=await e.json()}i(a.stages||[]),T(t.deals||[])}catch(e){console.error("Failed to fetch pipeline data:",e),M({title:"Error",description:"Failed to load pipeline data",variant:"destructive"})}finally{A(!1)}},O=async()=>{try{if(!L.title.trim())return void M({title:"Error",description:"Deal title is required",variant:"destructive"});let s={title:L.title,company_name:L.company_name,contact_name:L.contact_name,contact_email:L.contact_email,deal_value:L.deal_value?parseFloat(L.deal_value):null,expected_close_date:(e=>{if(!e)return null;let s=e.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(s))return s;let a=s.match(/^(\d{1,2})\.\s?(\d{1,2})\.\s?(\d{4})$/);if(a){let[,e,s,t]=a;return`${t}-${s.padStart(2,"0")}-${e.padStart(2,"0")}`}let t=s.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(t){let[,e,s,a]=t;return`${a}-${e.padStart(2,"0")}-${s.padStart(2,"0")}`}let l=new Date(s);if(!isNaN(l.getTime())){let e=l.getFullYear(),s=String(l.getMonth()+1).padStart(2,"0"),a=String(l.getDate()).padStart(2,"0");return`${e}-${s}-${a}`}return null})(L.expected_close_date||""),priority:L.priority,notes:L.notes,stage_id:e[0]?.id},a=await (0,k.fetchWithCsrf)("/api/sales/deals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await a.json();a.ok?(M({title:"Success",description:"Deal created successfully"}),E(!1),R({title:"",company_name:"",contact_name:"",contact_email:"",deal_value:"",expected_close_date:"",priority:"medium",notes:""}),H()):M({title:"Error",description:t.error||"Failed to create deal",variant:"destructive"})}catch(e){console.error("Failed to create deal:",e),M({title:"Error",description:"Failed to create deal",variant:"destructive"})}},$=e=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"$0";return D?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Sales Pipeline"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading your deals..."})]})}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4",children:[1,2,3,4,5,6].map(e=>(0,s.jsxs)(t.Card,{className:"animate-pulse",children:[(0,s.jsxs)(t.CardHeader,{className:"pb-3",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 mt-2"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:[1,2].map(e=>(0,s.jsx)("div",{className:"h-16 bg-gray-200 rounded"},e))})})]},e))})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Sales Pipeline"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Track and manage your deals across the sales process"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(j.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(N.Input,{placeholder:"Search deals...",value:I,onChange:e=>P(e.target.value),className:"pl-10 w-64"})]}),(0,s.jsxs)(v.DropdownMenu,{children:[(0,s.jsx)(v.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(l.Button,{variant:"outline",className:"gap-2",children:[(0,s.jsx)(u.Filter,{className:"h-4 w-4"}),"Filter"]})}),(0,s.jsxs)(v.DropdownMenuContent,{align:"end",children:[(0,s.jsx)(v.DropdownMenuItem,{onClick:()=>F(""),children:"All Stages"}),e.map(e=>(0,s.jsx)(v.DropdownMenuItem,{onClick:()=>F(e.id),children:e.name},e.id))]})]}),(0,s.jsxs)(l.Button,{className:"gap-2",onClick:()=>E(!0),children:[(0,s.jsx)(d.Plus,{className:"h-4 w-4"}),"New Deal"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,s.jsx)(o.DollarSign,{className:"h-6 w-6 text-blue-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Pipeline"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:$(_.reduce((e,s)=>e+(s.deal_value||0),0))})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,s.jsx)(m.TrendingUp,{className:"h-6 w-6 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Weighted Pipeline"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:$(_.reduce((e,s)=>{let a=s.deal_stages?.probability||0;return e+(s.deal_value||0)*a/100},0))})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,s.jsx)(h.Target,{className:"h-6 w-6 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Deals"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:_.filter(e=>"active"===e.status).length})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,s.jsx)(x.Calendar,{className:"h-6 w-6 text-orange-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Closing This Month"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:_.filter(e=>{if(!e.expected_close_date)return!1;let s=new Date(e.expected_close_date),a=new Date;return s.getMonth()===a.getMonth()&&s.getFullYear()===a.getFullYear()}).length})]})]})})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4 overflow-x-auto pb-4",children:e.map(e=>{let a,i,d=(a=e.id,_.filter(e=>{let s=!B||e.stage_id===B,t=!I||e.title.toLowerCase().includes(I.toLowerCase())||e.company_name?.toLowerCase().includes(I.toLowerCase())||e.contact_name?.toLowerCase().includes(I.toLowerCase());return e.stage_id===a&&s&&t})),o=(i=e.id,_.filter(e=>e.stage_id===i).reduce((e,s)=>e+(s.deal_value||0),0));return(0,s.jsxs)(t.Card,{className:"min-h-[600px]",children:[(0,s.jsxs)(t.CardHeader,{className:"pb-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,s.jsx)(t.CardTitle,{className:"text-sm font-medium",children:e.name})]}),(0,s.jsx)(r.Badge,{variant:"secondary",className:"text-xs",children:d.length})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.probability,"% win rate"]}),(0,s.jsx)("p",{className:"text-sm font-semibold",children:$(o)})]})]}),(0,s.jsxs)(t.CardContent,{className:"space-y-3",children:[d.map(a=>(0,s.jsx)(t.Card,{className:"cursor-move hover:shadow-md transition-shadow border-l-4",style:{borderLeftColor:e.color},children:(0,s.jsx)(t.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsx)("h4",{className:"font-medium text-sm leading-tight line-clamp-2",children:a.title}),(0,s.jsxs)(v.DropdownMenu,{children:[(0,s.jsx)(v.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:(0,s.jsx)(p,{className:"h-4 w-4"})})}),(0,s.jsxs)(v.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(v.DropdownMenuItem,{children:[(0,s.jsx)(g.Edit,{className:"h-4 w-4 mr-2"}),"Edit Deal"]}),(0,s.jsxs)(v.DropdownMenuItem,{className:"text-red-600",children:[(0,s.jsx)(f.Trash2,{className:"h-4 w-4 mr-2"}),"Delete Deal"]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`w-2 h-2 rounded-full ${(e=>{switch(e){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}})(a.priority)}`}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground capitalize",children:a.priority})]}),a.company_name&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-1",children:a.company_name}),a.contact_name&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n,{className:"h-5 w-5",children:(0,s.jsx)(c,{className:"text-xs",children:a.contact_name.split(" ").map(e=>e[0]).join("").toUpperCase()})}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground line-clamp-1",children:a.contact_name})]}),a.deal_value&&(0,s.jsx)("p",{className:"font-semibold text-sm",children:$(a.deal_value)}),a.expected_close_date&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(x.Calendar,{className:"h-3 w-3 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(a.expected_close_date).toLocaleDateString()})]})]})})},a.id)),0===d.length&&(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(h.Target,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"No deals in this stage"})]})]})]},e.id)})}),(0,s.jsx)(C.Dialog,{open:z,onOpenChange:E,children:(0,s.jsxs)(C.DialogContent,{className:"max-w-md",children:[(0,s.jsxs)(C.DialogHeader,{children:[(0,s.jsx)(C.DialogTitle,{children:"Create New Deal"}),(0,s.jsx)(C.DialogDescription,{children:"Add a new deal to your sales pipeline"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"deal-title",children:"Deal Title *"}),(0,s.jsx)(N.Input,{id:"deal-title",value:L.title,onChange:e=>R({...L,title:e.target.value}),placeholder:"Website Redesign Project"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"company-name",children:"Company Name"}),(0,s.jsx)(N.Input,{id:"company-name",value:L.company_name,onChange:e=>R({...L,company_name:e.target.value}),placeholder:"Acme Corp"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"deal-value",children:"Deal Value ($)"}),(0,s.jsx)(N.Input,{id:"deal-value",type:"number",value:L.deal_value,onChange:e=>R({...L,deal_value:e.target.value}),placeholder:"50000"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"contact-name",children:"Contact Name"}),(0,s.jsx)(N.Input,{id:"contact-name",value:L.contact_name,onChange:e=>R({...L,contact_name:e.target.value}),placeholder:"John Doe"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"contact-email",children:"Contact Email"}),(0,s.jsx)(N.Input,{id:"contact-email",type:"email",value:L.contact_email,onChange:e=>R({...L,contact_email:e.target.value}),placeholder:"john@acme.com"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"expected-close",children:"Expected Close Date"}),(0,s.jsx)(N.Input,{id:"expected-close",type:"date",value:L.expected_close_date,onChange:e=>R({...L,expected_close_date:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"priority",children:"Priority"}),(0,s.jsxs)(S.Select,{value:L.priority,onValueChange:e=>R({...L,priority:e}),children:[(0,s.jsx)(S.SelectTrigger,{children:(0,s.jsx)(S.SelectValue,{})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"low",children:"Low"}),(0,s.jsx)(S.SelectItem,{value:"medium",children:"Medium"}),(0,s.jsx)(S.SelectItem,{value:"high",children:"High"}),(0,s.jsx)(S.SelectItem,{value:"urgent",children:"Urgent"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(b.Textarea,{id:"notes",value:L.notes,onChange:e=>R({...L,notes:e.target.value}),placeholder:"Additional notes about this deal...",rows:3})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,s.jsx)(l.Button,{onClick:O,children:"Create Deal"})]})]})]})})]})}e.s(["SalesPipeline",()=>_],933703)},387739,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(970065),l=e.i(167881),r=e.i(994179),i=e.i(287336),n=e.i(25652),c=e.i(212426),d=e.i(620278),o=e.i(87316),m=e.i(217923),x=e.i(475254);let h=(0,x.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),u=(0,x.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var j=e.i(174117);function p(){let[e,x]=(0,a.useState)(null),[p,g]=(0,a.useState)(!0),[f,N]=(0,a.useState)("monthly"),[v,y]=(0,a.useState)(new Date().getFullYear()),{toast:C}=(0,j.useToast)();(0,a.useEffect)(()=>{w()},[f,v]);let w=async()=>{try{let e=await fetch(`/api/sales/forecasting?period=${f}&year=${v}`),s=await e.json();if((!s.forecasts||0===s.forecasts.length)&&(console.log("No forecast data found, setting up defaults..."),(await fetch("/api/setup/forecasts",{method:"POST"})).ok)){let e=await fetch(`/api/sales/forecasting?period=${f}&year=${v}`);s=await e.json()}x(s)}catch(e){console.error("Failed to fetch forecast data:",e),C({title:"Error",description:"Failed to load forecast data",variant:"destructive"})}finally{g(!1)}},b=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);if(p)return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Sales Forecasting"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading forecast data..."})]})}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,s.jsx)(t.Card,{className:"animate-pulse",children:(0,s.jsxs)(t.CardContent,{className:"p-6",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})},e))})]});let S=(()=>{if(!e?.forecasts?.length)return 0;let s=e.forecasts.filter(e=>e.actual_amount>0);return 0===s.length?0:Math.round(s.reduce((e,s)=>e+Math.min(s.actual_amount/s.forecast_amount,2),0)/s.length*100)})();return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Sales Forecasting"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Predict and track your sales performance"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("select",{value:f,onChange:e=>N(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[(0,s.jsx)("option",{value:"monthly",children:"Monthly"}),(0,s.jsx)("option",{value:"quarterly",children:"Quarterly"}),(0,s.jsx)("option",{value:"yearly",children:"Yearly"})]}),(0,s.jsx)("select",{value:v,onChange:e=>y(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:Array.from({length:5},(e,s)=>new Date().getFullYear()-2+s).map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),(0,s.jsxs)(l.Button,{children:[(0,s.jsx)(m.BarChart3,{className:"h-4 w-4 mr-2"}),"Update Forecast"]})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,s.jsx)(c.DollarSign,{className:"h-6 w-6 text-blue-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Pipeline"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:b(e?.pipeline_metrics?.total_pipeline??0)})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,s.jsx)(d.Target,{className:"h-6 w-6 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Weighted Pipeline"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:b(e?.pipeline_metrics?.weighted_pipeline??0)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Based on win probabilities"})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,s.jsx)(o.Calendar,{className:"h-6 w-6 text-orange-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Upcoming Deals"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:e?.pipeline_metrics?.upcoming_deals_count??0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Closing this month"})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,s.jsx)(n.TrendingUp,{className:"h-6 w-6 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Forecast Accuracy"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[S,"%"]}),(0,s.jsxs)("div",{className:"flex items-center mt-1",children:[S>=90?(0,s.jsx)(h,{className:"h-3 w-3 text-green-500 mr-1"}):(0,s.jsx)(u,{className:"h-3 w-3 text-red-500 mr-1"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:S>=90?"Excellent":S>=70?"Good":"Needs improvement"})]})]})]})})})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Forecast vs Actual Performance"}),(0,s.jsx)(t.CardDescription,{children:"Compare your forecasted amounts with actual closed deals"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(e?.forecasts??[]).map(e=>{let a=e.actual_amount>0?e.actual_amount/e.forecast_amount*100:0;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"font-medium",children:new Date(e.period_start).toLocaleDateString("en-US",{month:"short",year:"numeric"})}),(0,s.jsxs)(r.Badge,{variant:"outline",children:[e.confidence_percentage,"% confidence"]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-sm font-medium",children:[b(e.actual_amount)," / ",b(e.forecast_amount)]}),(0,s.jsxs)("p",{className:`text-xs ${a>=100?"text-green-600":"text-red-600"}`,children:[a.toFixed(1),"% of forecast"]})]})]}),(0,s.jsx)(i.Progress,{value:Math.min(a,100),className:"h-2"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,s.jsx)("span",{children:"0%"}),(0,s.jsxs)("span",{children:["Forecast: ",b(e.forecast_amount)]}),(0,s.jsx)("span",{children:"100%"})]})]},e.id)}),(!e?.forecasts||0===e.forecasts.length)&&(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(m.BarChart3,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,s.jsx)("p",{children:"No forecast data available for the selected period"}),(0,s.jsx)(l.Button,{className:"mt-4",children:"Create Your First Forecast"})]})]})})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Pipeline Health"}),(0,s.jsx)(t.CardDescription,{children:"Analysis of your sales pipeline"})]}),(0,s.jsx)(t.CardContent,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Average Deal Size"}),(0,s.jsx)("span",{className:"font-medium",children:b(e?.pipeline_metrics?.average_deal_size??0)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Pipeline Coverage"}),(0,s.jsxs)("span",{className:"font-medium",children:[e?.pipeline_metrics?.total_pipeline?Math.round((e?.pipeline_metrics?.weighted_pipeline??0)/(e?.pipeline_metrics?.total_pipeline||1)*100):0,"%"]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Deals Closing Soon"}),(0,s.jsxs)("span",{className:"font-medium",children:[e?.pipeline_metrics?.upcoming_deals_count??0," deals"]})]})]})})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsx)(t.CardTitle,{children:"Forecast Recommendations"}),(0,s.jsx)(t.CardDescription,{children:"AI-powered insights for better forecasting"})]}),(0,s.jsx)(t.CardContent,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Increase Confidence"}),(0,s.jsx)("p",{className:"text-xs text-blue-700",children:"Add more historical data to improve forecast accuracy"})]}),(0,s.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-green-900",children:"Pipeline Optimization"}),(0,s.jsx)("p",{className:"text-xs text-green-700",children:"Focus on deals with 60%+ win probability"})]}),(0,s.jsxs)("div",{className:"p-3 bg-orange-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-orange-900",children:"Seasonal Trends"}),(0,s.jsx)("p",{className:"text-xs text-orange-700",children:"Consider Q4 seasonality in your forecasts"})]})]})})]})]})]})}e.s(["SalesForecasting",()=>p],387739)},607461,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(970065),l=e.i(167881),r=e.i(994179),i=e.i(23750),n=e.i(10708),c=e.i(239616),d=e.i(269638),o=e.i(63209),m=e.i(39312),x=e.i(16715),h=e.i(475254);let u=(0,h.default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),j=(0,h.default)("unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);var p=e.i(846696);function g(){let[e,h]=(0,a.useState)({pipedrive:{configured:!1,connected:!1}}),[g,f]=(0,a.useState)(!0),[N,v]=(0,a.useState)(null),[y,C]=(0,a.useState)("");(0,a.useEffect)(()=>{w()},[]);let w=async()=>{try{let e=await fetch("/api/crm/pipedrive/config"),s=await e.json();h({pipedrive:{configured:s.config?.api_token==="configured",connected:"connected"===s.connection_status,user:s.user}})}catch(e){console.error("Failed to check CRM status:",e)}finally{f(!1)}},b=async()=>{if(!y.trim())return void p.toast.error("Please enter your Pipedrive API token");try{let e=await fetch("/api/crm/pipedrive/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_token:y,setup_webhooks:!0})}),s=await e.json();e.ok?(p.toast.success("Pipedrive connected successfully"),v(null),C(""),w()):p.toast.error(s?.message||s?.error||"Connection failed")}catch(e){p.toast.error("Failed to connect to Pipedrive")}},S=async()=>{(0,p.toast)("Disconnected",{description:"Pipedrive integration has been disabled"}),h(e=>({...e,pipedrive:{configured:!1,connected:!1}}))};return g?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"CRM Integrations"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading CRM status..."})]}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,s.jsx)(t.Card,{className:"animate-pulse",children:(0,s.jsxs)(t.CardContent,{className:"p-6",children:[(0,s.jsx)("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-4"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})},e))})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"CRM Integrations"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Connect your favorite CRM tools for seamless deal synchronization"})]}),N&&(0,s.jsxs)(t.Card,{className:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950/50",children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Settings,{className:"h-5 w-5"}),"Setup ",N]}),(0,s.jsxs)(t.CardDescription,{children:["Enter your ",N," credentials to enable integration"]})]}),(0,s.jsx)(t.CardContent,{className:"space-y-4",children:"Pipedrive"===N&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"api-token",children:"API Token"}),(0,s.jsx)(i.Input,{id:"api-token",type:"password",value:y,onChange:e=>C(e.target.value),placeholder:"Enter your Pipedrive API token"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Get your API token from Pipedrive Settings â†’ Personal Preferences â†’ API"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(l.Button,{onClick:b,children:"Connect Pipedrive"}),(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>v(null),children:"Cancel"})]})]})})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)(t.Card,{className:`transition-all duration-300 ${e.pipedrive.connected?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950/50":e.pipedrive.configured?"border-yellow-200 bg-yellow-50 dark:border-yellow-800 dark:bg-yellow-950/50":"border-gray-200"}`,children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-orange-600 dark:text-orange-400 font-bold text-lg",children:"P"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(t.CardTitle,{className:"text-lg",children:"Pipedrive"}),(0,s.jsx)(t.CardDescription,{children:"Sales CRM & Pipeline"})]})]}),(0,s.jsx)(r.Badge,{variant:e.pipedrive.connected?"default":e.pipedrive.configured?"secondary":"outline",children:e.pipedrive.connected?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.CheckCircle,{className:"h-3 w-3 mr-1"}),"Connected"]}):e.pipedrive.configured?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.AlertCircle,{className:"h-3 w-3 mr-1"}),"Configured"]}):"Not Connected"})]})}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[e.pipedrive.user&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Connected as: ",(0,s.jsx)("strong",{children:e.pipedrive.user.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(d.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)("span",{children:"Bidirektionale Deal-Synchronisation"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(d.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)("span",{children:"Real-time Webhook Updates"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(d.CheckCircle,{className:"h-4 w-4 text-green-500"}),(0,s.jsx)("span",{children:"Contact & Company Sync"})]})]}),(0,s.jsx)("div",{className:"flex gap-2",children:e.pipedrive.connected?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"flex-1",children:[(0,s.jsx)(x.RefreshCw,{className:"h-4 w-4 mr-2"}),"Sync Now"]}),(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:S,children:(0,s.jsx)(j,{className:"h-4 w-4"})})]}):(0,s.jsxs)(l.Button,{onClick:()=>v("Pipedrive"),className:"w-full",size:"sm",children:[(0,s.jsx)(u,{className:"h-4 w-4 mr-2"}),"Connect Pipedrive"]})})]})]}),(0,s.jsxs)(t.Card,{className:"border-gray-200 opacity-75",children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-orange-600 dark:text-orange-400 font-bold text-lg",children:"H"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(t.CardTitle,{className:"text-lg",children:"HubSpot"}),(0,s.jsx)(t.CardDescription,{children:"Marketing & Sales Hub"})]})]}),(0,s.jsx)(r.Badge,{variant:"outline",children:"Coming Soon"})]})}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"HubSpot CRM integration with contact scoring and workflow automation."}),(0,s.jsx)(l.Button,{disabled:!0,className:"w-full",size:"sm",children:"Coming Soon"})]})]}),(0,s.jsxs)(t.Card,{className:"border-gray-200 opacity-75",children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-blue-600 dark:text-blue-400 font-bold text-lg",children:"S"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(t.CardTitle,{className:"text-lg",children:"Salesforce"}),(0,s.jsx)(t.CardDescription,{children:"Enterprise CRM"})]})]}),(0,s.jsx)(r.Badge,{variant:"outline",children:"Coming Soon"})]})}),(0,s.jsxs)(t.CardContent,{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Salesforce integration with custom objects and advanced reporting."}),(0,s.jsx)(l.Button,{disabled:!0,className:"w-full",size:"sm",children:"Coming Soon"})]})]})]}),(0,s.jsxs)(t.Card,{children:[(0,s.jsxs)(t.CardHeader,{children:[(0,s.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(m.Zap,{className:"h-5 w-5"}),"Integration Benefits"]}),(0,s.jsx)(t.CardDescription,{children:"What you get with CRM integrations"})]}),(0,s.jsx)(t.CardContent,{children:(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(d.CheckCircle,{className:"h-5 w-5 text-green-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:"Automatic Sync"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Deals sync bidirectionally between systems"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(d.CheckCircle,{className:"h-5 w-5 text-green-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:"Real-time Updates"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Changes reflect immediately via webhooks"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(d.CheckCircle,{className:"h-5 w-5 text-green-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:"Data Consistency"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Single source of truth across all tools"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(d.CheckCircle,{className:"h-5 w-5 text-green-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:"Team Collaboration"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Everyone works with the same data"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(d.CheckCircle,{className:"h-5 w-5 text-green-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:"Advanced Reporting"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Unified analytics across platforms"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(d.CheckCircle,{className:"h-5 w-5 text-green-500 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium",children:"Workflow Automation"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Automated processes between systems"})]})]})]})})]})]})}e.s(["CRMIntegrations",()=>g],607461)},321758,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(970065),l=e.i(167881),r=e.i(994179),i=e.i(23750),n=e.i(10708),c=e.i(184762),d=e.i(62870),o=e.i(630374),m=e.i(107233),x=e.i(431343),h=e.i(495242),u=e.i(239616),j=e.i(39312),p=e.i(263488),g=e.i(503116),f=e.i(269638),N=e.i(727612),v=e.i(688511),y=e.i(174886),C=e.i(174117);function w(){let[e,w]=(0,a.useState)([]),[b,S]=(0,a.useState)(!0),[k,_]=(0,a.useState)(!1),[T,D]=(0,a.useState)("all"),[A,I]=(0,a.useState)({name:"",description:"",trigger_type:"lead_created",category:"automation",trigger_config:{},steps:[]}),{toast:P}=(0,C.useToast)();(0,a.useEffect)(()=>{B()},[T]);let B=async()=>{try{let e=new URLSearchParams;"all"!==T&&e.append("category",T);let s=await fetch(`/api/automation/workflows?${e}`),a=await s.json();w(a.workflows||[])}catch(e){console.error("Failed to fetch workflows:",e),P({title:"Error",description:"Failed to load workflows",variant:"destructive"})}finally{S(!1)}},F=async()=>{try{let e=await fetch("/api/automation/workflows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)}),s=await e.json();e.ok?(P({title:"Success",description:"Workflow created successfully"}),_(!1),I({name:"",description:"",trigger_type:"lead_created",category:"automation",trigger_config:{},steps:[]}),B()):P({title:"Error",description:s.error||"Failed to create workflow",variant:"destructive"})}catch(e){P({title:"Error",description:"Failed to create workflow",variant:"destructive"})}},z=async(e,s)=>{try{(await fetch("/api/automation/workflows",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,is_active:!s})})).ok&&(P({title:"Success",description:`Workflow ${!s?"activated":"deactivated"}`}),B())}catch(e){P({title:"Error",description:"Failed to update workflow",variant:"destructive"})}},E=async e=>{if(confirm("Are you sure you want to delete this workflow?"))try{(await fetch(`/api/automation/workflows?id=${e}`,{method:"DELETE"})).ok&&(P({title:"Success",description:"Workflow deleted successfully"}),B())}catch(e){P({title:"Error",description:"Failed to delete workflow",variant:"destructive"})}},L=e=>{switch(e){case"lead_created":return(0,s.jsx)(j.Zap,{className:"h-4 w-4"});case"deal_stage_changed":return(0,s.jsx)(f.CheckCircle,{className:"h-4 w-4"});case"email_opened":return(0,s.jsx)(p.Mail,{className:"h-4 w-4"});case"time_based":return(0,s.jsx)(g.Clock,{className:"h-4 w-4"});default:return(0,s.jsx)(u.Settings,{className:"h-4 w-4"})}};return b?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Workflow Automation"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading workflows..."})]})}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,s.jsx)(t.Card,{className:"animate-pulse",children:(0,s.jsxs)(t.CardContent,{className:"p-6",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})},e))})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Workflow Automation"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Create automated workflows to streamline your sales processes"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(d.Select,{value:T,onValueChange:D,children:[(0,s.jsx)(d.SelectTrigger,{className:"w-40",children:(0,s.jsx)(d.SelectValue,{})}),(0,s.jsxs)(d.SelectContent,{children:[(0,s.jsx)(d.SelectItem,{value:"all",children:"All Categories"}),(0,s.jsx)(d.SelectItem,{value:"automation",children:"Automation"}),(0,s.jsx)(d.SelectItem,{value:"nurturing",children:"Nurturing"}),(0,s.jsx)(d.SelectItem,{value:"follow_up",children:"Follow-up"}),(0,s.jsx)(d.SelectItem,{value:"scoring",children:"Scoring"})]})]}),(0,s.jsxs)(o.Dialog,{open:k,onOpenChange:_,children:[(0,s.jsx)(o.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(l.Button,{children:[(0,s.jsx)(m.Plus,{className:"h-4 w-4 mr-2"}),"Create Workflow"]})}),(0,s.jsxs)(o.DialogContent,{className:"max-w-2xl",children:[(0,s.jsxs)(o.DialogHeader,{children:[(0,s.jsx)(o.DialogTitle,{children:"Create New Workflow"}),(0,s.jsx)(o.DialogDescription,{children:"Set up an automated workflow to handle repetitive tasks"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"name",children:"Workflow Name"}),(0,s.jsx)(i.Input,{id:"name",value:A.name,onChange:e=>I({...A,name:e.target.value}),placeholder:"Welcome Email Sequence"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"category",children:"Category"}),(0,s.jsxs)(d.Select,{value:A.category,onValueChange:e=>I({...A,category:e}),children:[(0,s.jsx)(d.SelectTrigger,{children:(0,s.jsx)(d.SelectValue,{})}),(0,s.jsxs)(d.SelectContent,{children:[(0,s.jsx)(d.SelectItem,{value:"automation",children:"Automation"}),(0,s.jsx)(d.SelectItem,{value:"nurturing",children:"Nurturing"}),(0,s.jsx)(d.SelectItem,{value:"follow_up",children:"Follow-up"}),(0,s.jsx)(d.SelectItem,{value:"scoring",children:"Scoring"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"description",children:"Description"}),(0,s.jsx)(c.Textarea,{id:"description",value:A.description,onChange:e=>I({...A,description:e.target.value}),placeholder:"Describe what this workflow does...",rows:3})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"trigger_type",children:"Trigger Type"}),(0,s.jsxs)(d.Select,{value:A.trigger_type,onValueChange:e=>I({...A,trigger_type:e}),children:[(0,s.jsx)(d.SelectTrigger,{children:(0,s.jsx)(d.SelectValue,{})}),(0,s.jsxs)(d.SelectContent,{children:[(0,s.jsx)(d.SelectItem,{value:"lead_created",children:"New Lead Created"}),(0,s.jsx)(d.SelectItem,{value:"deal_stage_changed",children:"Deal Stage Changed"}),(0,s.jsx)(d.SelectItem,{value:"email_opened",children:"Email Opened"}),(0,s.jsx)(d.SelectItem,{value:"time_based",children:"Time-based"}),(0,s.jsx)(d.SelectItem,{value:"webhook",children:"Webhook Trigger"})]})]})]})}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),(0,s.jsx)(l.Button,{onClick:F,children:"Create Workflow"})]})]})]})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.map(e=>(0,s.jsxs)(t.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:L(e.trigger_type)}),(0,s.jsxs)("div",{children:[(0,s.jsx)(t.CardTitle,{className:"text-lg",children:e.name}),(0,s.jsx)(t.CardDescription,{className:"line-clamp-2",children:e.description||"No description"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.Badge,{className:(e=>{switch(e){case"nurturing":return"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300";case"follow_up":return"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300";case"automation":return"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300";case"scoring":return"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300";default:return"bg-gray-100 text-gray-700 dark:bg-gray-900 dark:text-gray-300"}})(e.category),children:e.category}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>z(e.id,e.is_active),children:e.is_active?(0,s.jsx)(h.Pause,{className:"h-4 w-4 text-orange-500"}):(0,s.jsx)(x.Play,{className:"h-4 w-4 text-green-500"})})]})]})}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Executions"}),(0,s.jsx)("div",{className:"font-semibold",children:e.execution_count})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Success Rate"}),(0,s.jsxs)("div",{className:"font-semibold",children:[e.success_rate.toFixed(1),"%"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[L(e.trigger_type),(0,s.jsx)("span",{className:"capitalize",children:e.trigger_type.replace("_"," ")}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsx)("span",{children:new Date(e.created_at).toLocaleDateString()})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"flex-1",children:[(0,s.jsx)(v.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"flex-1",children:[(0,s.jsx)(y.Copy,{className:"h-4 w-4 mr-2"}),"Duplicate"]}),(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>E(e.id),children:(0,s.jsx)(N.Trash2,{className:"h-4 w-4"})})]})]})]},e.id)),0===e.length&&(0,s.jsx)(t.Card,{className:"col-span-full border-dashed",children:(0,s.jsxs)(t.CardContent,{className:"py-16 text-center",children:[(0,s.jsx)(j.Zap,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No workflows yet"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:"Create your first automated workflow to get started"}),(0,s.jsxs)(l.Button,{onClick:()=>_(!0),children:[(0,s.jsx)(m.Plus,{className:"h-4 w-4 mr-2"}),"Create Your First Workflow"]})]})})]}),e.filter(e=>e.is_template).length>0&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Workflow Templates"}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:e.filter(e=>e.is_template).map(e=>(0,s.jsx)(t.Card,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 border-dashed",children:(0,s.jsxs)(t.CardContent,{className:"p-6 text-center",children:[(0,s.jsx)("div",{className:"p-3 bg-primary/10 rounded-lg w-fit mx-auto mb-4",children:L(e.trigger_type)}),(0,s.jsx)("h3",{className:"font-semibold mb-2",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:e.description}),(0,s.jsxs)(l.Button,{size:"sm",variant:"outline",children:[(0,s.jsx)(y.Copy,{className:"h-4 w-4 mr-2"}),"Use Template"]})]})},e.id))})]})]})}e.s(["WorkflowAutomation",()=>w])},990605,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(970065),l=e.i(167881),r=e.i(994179),i=e.i(23750),n=e.i(10708),c=e.i(184762),d=e.i(62870),o=e.i(127341),m=e.i(630374),x=e.i(283086),h=e.i(107233),u=e.i(239616),j=e.i(620278),p=e.i(39312),g=e.i(217923),f=e.i(688511),N=e.i(727612),v=e.i(174886),y=e.i(431343),C=e.i(495242),w=e.i(25652),b=e.i(286536),S=e.i(296112);let k=(0,e.i(475254).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);var _=e.i(174117);function T(){let[e,T]=(0,a.useState)([]),[D,A]=(0,a.useState)(!0),[I,P]=(0,a.useState)(!1),[B,F]=(0,a.useState)("rules"),[z,E]=(0,a.useState)({name:"",description:"",content_type:"email",trigger_conditions:{},personalization_rules:{},ai_enhancement:!0}),{toast:L}=(0,_.useToast)();(0,a.useEffect)(()=>{R()},[]);let R=async()=>{try{let e=await fetch("/api/content/personalization-rules"),s=await e.json();T(s.rules||[])}catch(e){console.error("Failed to fetch rules:",e),L({title:"Error",description:"Failed to load personalization rules",variant:"destructive"})}finally{A(!1)}},M=async()=>{try{let e=await fetch("/api/content/personalization-rules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)}),s=await e.json();e.ok?(L({title:"Success",description:"Personalization rule created successfully"}),P(!1),E({name:"",description:"",content_type:"email",trigger_conditions:{},personalization_rules:{},ai_enhancement:!0}),R()):L({title:"Error",description:s.error||"Failed to create rule",variant:"destructive"})}catch(e){L({title:"Error",description:"Failed to create personalization rule",variant:"destructive"})}},H=async e=>{if(confirm("Are you sure you want to delete this rule?"))try{(await fetch(`/api/content/personalization-rules?id=${e}`,{method:"DELETE"})).ok&&(L({title:"Success",description:"Rule deleted successfully"}),R())}catch(e){L({title:"Error",description:"Failed to delete rule",variant:"destructive"})}};return D?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Content Personalization"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading personalization engine..."})]})}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3].map(e=>(0,s.jsx)(t.Card,{className:"animate-pulse",children:(0,s.jsxs)(t.CardContent,{className:"p-6",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})},e))})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Content Personalization Engine"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"AI-powered content adaptation and real-time optimization"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(r.Badge,{variant:"secondary",className:"animate-pulse",children:[(0,s.jsx)(x.Sparkles,{className:"h-3 w-3 mr-1"}),"AI Powered"]}),(0,s.jsxs)(l.Button,{onClick:()=>P(!0),children:[(0,s.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Create Rule"]})]})]}),(0,s.jsxs)(o.Tabs,{value:B,onValueChange:F,children:[(0,s.jsxs)(o.TabsList,{children:[(0,s.jsx)(o.TabsTrigger,{value:"rules",children:"Personalization Rules"}),(0,s.jsx)(o.TabsTrigger,{value:"blocks",children:"Dynamic Blocks"}),(0,s.jsx)(o.TabsTrigger,{value:"optimization",children:"A/B Testing"}),(0,s.jsx)(o.TabsTrigger,{value:"analytics",children:"Performance"})]}),(0,s.jsx)(o.TabsContent,{value:"rules",className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.map(e=>(0,s.jsxs)(t.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,s.jsx)(t.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 bg-primary/10 rounded-lg",children:(0,s.jsx)(j.Target,{className:"h-4 w-4 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(t.CardTitle,{className:"text-lg",children:e.name}),(0,s.jsx)(t.CardDescription,{className:"capitalize",children:e.content_type.replace("_"," ")})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.ai_enhancement&&(0,s.jsxs)(r.Badge,{variant:"secondary",className:"text-xs",children:[(0,s.jsx)(p.Zap,{className:"h-3 w-3 mr-1"}),"AI"]}),(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{},children:e.is_active?(0,s.jsx)(C.Pause,{className:"h-4 w-4 text-orange-500"}):(0,s.jsx)(y.Play,{className:"h-4 w-4 text-green-500"})})]})]})}),(0,s.jsxs)(t.CardContent,{className:"space-y-4",children:[e.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Usage"}),(0,s.jsx)("div",{className:"font-semibold",children:e.usage_count})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Performance"}),(0,s.jsxs)("div",{className:"font-semibold",children:[e.performance_score.toFixed(1),"%"]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"text-xs font-medium text-muted-foreground",children:"Triggers:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(e.trigger_conditions).map(([e,a])=>(0,s.jsxs)(r.Badge,{variant:"outline",className:"text-xs",children:[e,": ",Array.isArray(a)?a.join(", "):String(a)]},e))})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"flex-1",children:[(0,s.jsx)(f.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,s.jsxs)(l.Button,{variant:"outline",size:"sm",className:"flex-1",children:[(0,s.jsx)(v.Copy,{className:"h-4 w-4 mr-2"}),"Duplicate"]}),(0,s.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>H(e.id),children:(0,s.jsx)(N.Trash2,{className:"h-4 w-4"})})]})]})]},e.id)),(0,s.jsx)(t.Card,{className:"border-dashed border-2 hover:border-primary/50 transition-colors cursor-pointer",children:(0,s.jsxs)(t.CardContent,{className:"p-6 text-center",children:[(0,s.jsx)("div",{className:"p-3 bg-primary/10 rounded-lg w-fit mx-auto mb-4",children:(0,s.jsx)(h.Plus,{className:"h-6 w-6 text-primary"})}),(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Create New Rule"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Add personalized content rules for different lead segments"}),(0,s.jsx)(l.Button,{onClick:()=>P(!0),children:"Add Rule"})]})})]})}),(0,s.jsx)(o.TabsContent,{value:"blocks",className:"space-y-6",children:(0,s.jsx)(t.Card,{children:(0,s.jsxs)(t.CardContent,{className:"p-8 text-center",children:[(0,s.jsx)("div",{className:"p-4 bg-blue-100 dark:bg-blue-900/50 rounded-lg w-fit mx-auto mb-4",children:(0,s.jsx)(u.Settings,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Dynamic Content Blocks"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:"Create reusable content components that adapt based on lead characteristics"}),(0,s.jsxs)(l.Button,{children:[(0,s.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Create Dynamic Block"]})]})})}),(0,s.jsx)(o.TabsContent,{value:"optimization",className:"space-y-6",children:(0,s.jsx)(t.Card,{children:(0,s.jsxs)(t.CardContent,{className:"p-8 text-center",children:[(0,s.jsx)("div",{className:"p-4 bg-green-100 dark:bg-green-900/50 rounded-lg w-fit mx-auto mb-4",children:(0,s.jsx)(g.BarChart3,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"A/B Testing & Optimization"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-6",children:"Run real-time A/B tests to optimize content performance"}),(0,s.jsxs)(l.Button,{children:[(0,s.jsx)(y.Play,{className:"h-4 w-4 mr-2"}),"Start New Test"]})]})})}),(0,s.jsx)(o.TabsContent,{value:"analytics",className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,s.jsx)(b.Eye,{className:"h-6 w-6 text-blue-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg. Open Rate"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:"24.5%"}),(0,s.jsx)("p",{className:"text-xs text-green-600",children:"+2.1% vs last month"})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,s.jsx)(S.MousePointer,{className:"h-6 w-6 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Click Rate"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:"8.2%"}),(0,s.jsx)("p",{className:"text-xs text-green-600",children:"+1.5% vs last month"})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,s.jsx)(k,{className:"h-6 w-6 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Conversions"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:"156"}),(0,s.jsx)("p",{className:"text-xs text-green-600",children:"+12 vs last month"})]})]})})}),(0,s.jsx)(t.Card,{children:(0,s.jsx)(t.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,s.jsx)(w.TrendingUp,{className:"h-6 w-6 text-orange-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Personalization Lift"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:"+34%"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"vs non-personalized"})]})]})})})]})})]}),(0,s.jsx)(m.Dialog,{open:I,onOpenChange:P,children:(0,s.jsxs)(m.DialogContent,{className:"max-w-2xl",children:[(0,s.jsxs)(m.DialogHeader,{children:[(0,s.jsx)(m.DialogTitle,{children:"Create Personalization Rule"}),(0,s.jsx)(m.DialogDescription,{children:"Define rules for dynamic content personalization based on lead characteristics"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"rule-name",children:"Rule Name"}),(0,s.jsx)(i.Input,{id:"rule-name",value:z.name,onChange:e=>E({...z,name:e.target.value}),placeholder:"Enterprise Welcome"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"content-type",children:"Content Type"}),(0,s.jsxs)(d.Select,{value:z.content_type,onValueChange:e=>E({...z,content_type:e}),children:[(0,s.jsx)(d.SelectTrigger,{children:(0,s.jsx)(d.SelectValue,{})}),(0,s.jsxs)(d.SelectContent,{children:[(0,s.jsx)(d.SelectItem,{value:"email",children:"Email"}),(0,s.jsx)(d.SelectItem,{value:"landing_page",children:"Landing Page"}),(0,s.jsx)(d.SelectItem,{value:"social_post",children:"Social Post"}),(0,s.jsx)(d.SelectItem,{value:"ad_copy",children:"Ad Copy"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{htmlFor:"description",children:"Description"}),(0,s.jsx)(c.Textarea,{id:"description",value:z.description,onChange:e=>E({...z,description:e.target.value}),placeholder:"Describe when and how this rule should be applied...",rows:3})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"ai-enhancement",checked:z.ai_enhancement,onChange:e=>E({...z,ai_enhancement:e.target.checked}),className:"rounded"}),(0,s.jsxs)(n.Label,{htmlFor:"ai-enhancement",className:"flex items-center gap-2",children:[(0,s.jsx)(p.Zap,{className:"h-4 w-4"}),"Enable AI Enhancement"]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),(0,s.jsx)(l.Button,{onClick:M,children:"Create Rule"})]})]})]})})]})}e.s(["ContentPersonalizationEngine",()=>T],990605)}]);